$={id:function(a){return document.getElementById(a)},cls:function(a,b){return(b||document).getElementsByClassName(a)},byName:function(a){return document.getElementsByName(a)},tag:function(a,b){return(b||document).getElementsByTagName(a)},extend:function(a,b){for(var c in b)a[c]=b[c]}};document.documentElement.classList?($.hasClass=function(a,b){return a.classList.contains(b)},$.addClass=function(a,b){a.classList.add(b)},$.removeClass=function(a,b){a.classList.remove(b)}):($.hasClass=function(a,b){return-1!=(" "+a.className+" ").indexOf(" "+b+" ")},$.addClass=function(a,b){a.className=""==a.className?b:a.className+" "+b},$.removeClass=function(a,b){a.className=(" "+a.className+" ").replace(" "+b+" ","")});$.get=function(a,b,c){var d,e;e=new XMLHttpRequest;e.open("GET",a);if(b)for(d in b)e[d]=b[d];if(c)for(d in c)e.setRequestHeader(d,c[d]);e.send(null);return e};$.hash=function(a){var b,c,d=0;b=0;for(c=a.length;b<c;++b)d=(d<<5)-d+a.charCodeAt(b);return d};var Parser={init:function(){var a,b,c,d;if(Config.filter||Config.embedSoundCloud||Config.embedYouTube)this.needMsg=!0;if(Config.imageSearch||Config.downloadFile)this.needFile=!0;a=2<=window.devicePixelRatio?"@2x.gif":".gif";this.icons={admin:"//static.4chan.org/image/adminicon"+a,mod:"//static.4chan.org/image/modicon"+a,dev:"//static.4chan.org/image/developericon"+a,del:"//static.4chan.org/image/filedeleted-res"+a};this.prettify="function"==typeof prettyPrint;this.customSpoiler={};Config.localTime&&((a=(new Date).getTimezoneOffset())?(b=Math.abs(a),c=0|b/60,this.utcOffset=" UTC"+(0>a?"+":"-")+c+((d=b-60*c)?":"+d:"")):this.utcOffset=" UTC",this.weekdays="Sun Mon Tue Wed Thu Fri Sat".split(" "))},inlineQuote:function(a,b){var c,d,e,f,g,k,h;if(c=a.getAttribute("data-pfx"))return a.removeAttribute("data-pfx"),$.removeClass(a,"linkfade"),g=$.id(c+"p"+a.textContent.slice(2)),g.parentNode.removeChild(g),b&&b.preventDefault();c=Date.now();f=a.textContent.slice(2);if((d=$.id("p"+f))&&!$.hasClass(d,"op"))if(b&&b.preventDefault(),"backlink"==(e=a.parentNode.parentNode).className?(g=e.parentNode.parentNode.parentNode,k=!0):g=e.parentNode.parentNode,g.id.split("m")[1]!=f){a.className+=" linkfade";a.setAttribute("data-pfx",c);g=d.cloneNode(!0);g.id=c+g.id;g.setAttribute("data-pfx",c);g.className+=" preview inlined";$.removeClass(g,"highlight");$.removeClass(g,"highlight-anti");if((h=$.cls("inlined",g))[0]){for(;f=h[0];)f.parentNode.removeChild(f);h=$.cls("quotelink",g);for(d=0;f=h[d];++d)f.removeAttribute("data-pfx"),$.removeClass(f,"linkfade")}for(d=0;f=g.children[d];++d)f.id=c+f.id;if(d=$.cls("backlink",g)[0])d.id=c+d.id;k?(c=e.parentNode.parentNode.getAttribute("data-pfx")||"",e=$.id(c+"m"+e.id.split("_")[1]),e.insertBefore(g,e.firstChild)):(e=a.parentNode,e.parentNode.insertBefore(g,e.nextSibling))}},parseThreadJSON:function(a){var b;try{b=JSON.parse(a).posts}catch(c){console.log(c),b=[]}return b},setCustomSpoiler:function(a,b){var c;if(!this.customSpoiler[a]&&(b=parseInt(b)))this.customSpoiler[a]=a==Main.board&&(c=$.cls("imgspoiler")[0])?c.firstChild.src.match(/spoiler(-[a-z0-9]+)\.png$/)[1]:"-"+a+(Math.floor(Math.random()*b)+1)},buildHTMLFromJSON:function(a,b){var c=document.createElement("div"),d=!1,e,f="",g="",k="",g="",h,l=f=k="",m="",p="",n="",q="",r="",u,w="",x="",y="",s,t,v,z="//images.4chan.org/"+b+"/src";0==a.resto&&(d=!0,a.resto=a.no);t=a.resto+"#p"+a.no;!Main.tid||b!=Main.board?(t="res/"+t,v="res/"+a.resto+"#q"+a.no):v="javascript:quote('"+a.no+"')";e=!a.capcode&&a.id?' <span class="posteruid id_'+
a.id+'">(ID: <span class="hand" title="Highlight posts by this ID">'+a.id+"</span>)</span> ":"";switch(a.capcode){case"admin_highlight":w=" highlightPost";case"admin":n=' <strong class="capcode hand id_admin"title="Highlight posts by the Administrator">## Admin</strong>';q=" capcodeAdmin";r=' <img src="'+Parser.icons.admin+'" alt="This user is the 4chan Administrator." title="This user is the 4chan Administrator." class="identityIcon">';break;case"mod":n=' <strong class="capcode hand id_mod" title="Highlight posts by Moderators">## Mod</strong>';q=" capcodeMod";r=' <img src="'+Parser.icons.mod+'" alt="This user is a 4chan Moderator." title="This user is a 4chan Moderator." class="identityIcon">';break;case"developer":n=' <strong class="capcode hand id_developer" title="Highlight posts by Developers">## Developer</strong>',q=" capcodeDeveloper",r=' <img src="'+Parser.icons.dev+'" alt="This user is a 4chan Developer." title="This user is a 4chan Developer." class="identityIcon">'}a.email&&(x='<a href="mailto:'+a.email.replace(/ /g,"%20")+'" class="useremail">',y="</a>");u=a.country?' <img src="//static.4chan.org/image/country/'+("pol"==b?"troll/":"")+a.country.toLowerCase()+'.gif" alt="'+a.country+'" title="'+a.country_name+'" class="countryFlag">':"";if(a.ext){l=m=a.filename+a.ext;if(a.filename.length>(d?40:30))l=a.filename.slice(0,d?35:25)+"(...)"+a.ext;!a.tn_w&&(!a.tn_h&&".gif"==a.ext)&&(a.tn_w=a.w,a.tn_h=a.h);k=1048576<=a.fsize?(0|100*(a.fsize/1048576)+0.5)/100+" M":1024<a.fsize?(0|a.fsize/1024+0.5)+" K":a.fsize+" ";a.spoiler&&(k="Spoiler Image, "+k,Config.revealSpoilers||(f=" imgspoiler",h="//static.4chan.org/image/spoiler"+(Parser.customSpoiler[b]||"")+".png",a.tn_w=100,a.tn_h=100,s=!0));h||(h="//thumbs.4chan.org/"+b+"/thumb/"+a.tim+"s.jpg");g='<a class="fileThumb'+f+'" href="'+z+"/"+a.tim+a.ext+'" target="_blank"><img src="'+h+'" alt="'+k+'B" data-md5="'+a.md5+'" style="height: '+a.tn_h+"px; width: "+a.tn_w+'px;"></a>';f=".pdf"==a.ext?"PDF":a.w+"x"+a.h;k='<span class="fileText" id="fT'+a.no+'">File: <a href="'+z+"/"+
a.tim+a.ext+'" target="_blank">'+a.tim+a.ext+"</a>-("+k+"B, "+f+(s?"":', <span title="'+m+'">'+l+"</span>")+")</span>";g='<div id="f'+a.no+'" class="file">'+(k?'<div class="fileInfo">':"")+k+(k?"</div>":"")+g+"</div>"}else a.filedeleted&&(g='<div id="f'+a.no+'" class="file"><span class="fileThumb"><img src="'+Parser.icons.del+'" class="fileDeletedRes" alt="File deleted."></span></div>');a.trip&&(p=' <span class="postertrip">'+a.trip+"</span>");h=a.name||"";s=a.sub||"";c.className="postContainer replyContainer";c.id="pc"+a.no;c.innerHTML='<div class="sideArrows" id="sa'+a.no+'">&gt;&gt;</div><div id="p'+a.no+'" class="post '+(d?"op":"reply")+w+'"><div class="postInfoM mobile" id="pim'+a.no+'"><span class="nameBlock'+q+'"><span class="name">'+h+"</span>"+p+n+r+e+u+'<br><span class="subject">'+s+'</span></span><span class="dateTime postNum" data-utc="'+a.time+'">'+a.now+'<br><em><a href="'+a.no+"#p"+a.no+'">No.</a><a href="javascript:quote(\''+a.no+"');\">"+a.no+"</a></em></span></div>"+(d?g:"")+'<div class="postInfo desktop" id="pi'+
a.no+'"><input type="checkbox" name="'+a.no+'" value="delete"> <span class="subject">'+s+'</span> <span class="nameBlock'+q+'">'+x+'<span class="name">'+h+"</span>"+p+n+y+r+e+u+' </span> <span class="dateTime" data-utc="'+a.time+'">'+a.now+'</span> <span class="postNum desktop"><a href="'+t+'" title="Highlight this post">No.</a><a href="'+v+'" title="Quote this post">'+a.no+"</a></span></div>"+(d?"":g)+'<blockquote class="postMessage" id="m'+a.no+'">'+(a.com||"")+"</blockquote> </div>";if(!Main.tid||b!=Main.board){n=c.getElementsByClassName("quotelink");for(d=0;e=n[d];++d)p=e.getAttribute("href"),"/"!=p.charAt(0)&&(e.href="/"+b+"/res/"+p)}return c},parseBoard:function(){var a,b=document.getElementsByClassName("thread");for(a=0;b[a];++a)Parser.parseThread(b[a].id.slice(1))},parseThread:function(a,b,c){var d,e,f,g,k,h;f=$.id("t"+a);g=f.getElementsByClassName("post");if(!b){d=document.getElementById("pi"+a);if(!Main.tid&&(Config.filter&&(e=Filter.exec(f,d,f.getElementsByClassName("nameBlock")[0],document.getElementById("m"+a),a)),Config.threadHiding&&!e&&(e=document.createElement("span"),e.id="sa"+a,e.alt="H",e.innerHTML='<img class="extButton threadHideButton"data-cmd="hide" data-id="'+a+'" src="'+Main.icons.minus+'" title="Toggle thread">',g[0].insertBefore(e,g[0].firstChild),ThreadHiding.hidden[a]&&(ThreadHiding.hidden[a]=Main.now,ThreadHiding.hide(a))),ThreadExpansion.enabled&&(k=$.cls("summary",f)[0])))f=document.createDocumentFragment(),h=k.cloneNode(!0),h.className="",k.textContent="",e=document.createElement("img"),e.className="extButton expbtn",e.title="Expand thread",e.alt="+",e.setAttribute("data-cmd","expand"),e.setAttribute("data-id",a),e.src=Main.icons.plus,f.appendChild(e),f.appendChild(h),e=document.createElement("span"),e.style.display="none",e.textContent="Showing all replies.",f.appendChild(e),k.appendChild(f);Config.threadWatcher&&(e=document.createElement("img"),e.className="extButton wbtn",ThreadWatcher.watched[k=a+"-"+Main.board]?(e.src=Main.icons.watched,e.setAttribute("data-active","1")):e.src=Main.icons.notwatched,e.id="wbtn-"+k,e.setAttribute("data-cmd","watch"),e.setAttribute("data-id",a),e.alt="W",e.title="Add to watch list",d.insertBefore(e,d.firstChild))}e=b?0>b?g.length+b:b:0;c=c?e+c:g.length;for(d=e;d<c;++d)Parser.parsePost(g[d].id.slice(1),a);if(b&&Parser.prettify)for(d=e;d<c;++d)Parser.parseMarkup(g[d]);UA.hasCustomEventCtor&&document.dispatchEvent(new CustomEvent("4chanParsingDone",{detail:{threadId:a,offset:e,limit:c}}))},parseMarkup:function(a){var b,c;if((b=a.getElementsByClassName("prettyprint"))[0])for(a=0;c=b[a];++a)c.innerHTML=prettyPrintOne(c.innerHTML)},parsePost:function(a,b){var c,d,e,f,g,k,h,l;if(b){e=document.getElementById("pi"+a);Parser.needMsg&&(f=document.getElementById("m"+a));h="";Config.reportButton&&(h+='<img class="extButton" alt="!" data-cmd="report" data-id="'+a+'" src="'+Main.icons.report+'" title="Report">');h&&(c=document.createElement("div"),c.className="extControls",c.innerHTML=h,e.appendChild(c));if(Parser.needFile&&(g=document.getElementById("fT"+a)))h="",Config.downloadFile&&(c=((d=g.children[1])?d:g).getAttribute("title"),h+='<a href="'+g.firstElementChild.href+'" download="'+c+'" title="Download file"><img class="extButton" src="'+Main.icons.download+'" alt="D"></a>'),Config.imageSearch&&(c=g.firstElementChild.href,h+='<a href="//www.google.com/searchbyimage?image_url='+c+'" target="_blank" title="Google Image Search"><img class="extButton" src="'+Main.icons.gis+'" alt="G"></a><a href="http://iqdb.org/?url='+c+'" target="_blank" title="iqdb"><img class="extButton" src="'+
Main.icons.iqdb+'" alt="I"></a>'),h&&(c=document.createElement("div"),c.className="extControls",c.innerHTML=h,g.parentNode.appendChild(c));a!=b&&(Config.filter&&(k=Filter.exec(e.parentNode,e,e.children[2],f)),Config.replyHiding&&!k&&(d=document.getElementById("sa"+a),d.innerHTML='<img class="extButton replyHideButton" data-cmd="hide-r" data-id="'+a+'" src="'+Main.icons.minus+'" title="Toggle reply">',ReplyHiding.hidden[a]&&(ReplyHiding.hidden[a]=Main.now,ReplyHiding.hide(a))),Config.backlinks&&Parser.parseBacklinks(a,b));IDColor.enabled&&(l=$.cls("posteruid",e)[0])&&IDColor.apply(l.firstElementChild);Main.tid&&(Config.embedSoundCloud&&Media.parseSoundCloud(f),Config.embedYouTube&&Media.parseYouTube(f))}else e=a.getElementsByClassName("postInfo")[0],a=e.id.slice(2);if(Config.revealSpoilers&&((g=document.getElementById("f"+a))&&(g=g.children[1]))&&$.hasClass(g,"imgspoiler"))f=g.firstChild,g.removeChild(f),f.removeAttribute("style"),c=$.hasClass(e.parentNode,"op"),f.style.maxWidth=f.style.maxHeight=c?"250px":"125px",f.src="//thumbs.4chan.org"+g.pathname.replace(/src(\/[0-9]+).+$/,"thumb$1s.jpg"),k=g.previousElementSibling.firstElementChild,h=k.title.split("."),c=h[0].length>(c?40:30)?h[0].slice(0,c?35:25)+"(...)"+h[1]:k.title,k.lastChild.textContent=k.lastChild.textContent.slice(0,-1)+", "+c+")",g.appendChild(f);Config.localTime&&(d=e.getElementsByClassName("dateTime")[0],d.textContent=Parser.getLocaleDate(new Date(1E3*d.getAttribute("data-utc")))+this.utcOffset)},getLocaleDate:function(a){return("0"+(1+a.getMonth())).slice(-2)+"/"+("0"+a.getDate()).slice(-2)+"/"+("0"+a.getFullYear()).slice(-2)+"/("+this.weekdays[a.getDay()]+")"+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2)},parseBacklinks:function(a,b){var c,d,e,f,g,k,h;if(e=document.getElementById("m"+a).getElementsByClassName("quotelink")){f={};for(c=0;d=e[c];++c)if(g=d.getAttribute("href").split("#p"),g[1])if(g[1]==b&&(d.textContent+=" (OP)"),k=document.getElementById("pi"+g[1])){if(!f[g[1]]){f[g[1]]=!0;d=document.createElement("span");d.innerHTML='<a href="#p'+a+'" class="quotelink">&gt;&gt;'+a+"</a> ";if(!(h=document.getElementById("bl_"+g[1])))h=document.createElement("div"),h.id="bl_"+g[1],h.className="backlink",h.innerHTML="Replies: ",k.appendChild(h);h.appendChild(d)}}else Main.tid&&"/"!=g[0].charAt(0)&&(d.textContent+=" \u2192")}}},QuotePreview={init:function(){this.unlink={rs:!0,f:!0};this.debounce=200;this.timeout=null;this.cached={};this.highlightAnti=this.highlight=null;this.out=!0},resolve:function(a){var b,c,d,e;b=QuotePreview;b.out=!1;if((c=a.getAttribute("href").match(/^(?:\/([^\/]+)\/)?(?:res\/)?([0-9]+)?#p([0-9]+)$/))&&!b.unlink[c[1]])(d=document.getElementById("p"+c[3]))?(c=d.getBoundingClientRect(),0<c.top&&c.bottom<document.documentElement.clientHeight&&!$.hasClass(d.parentNode,"post-hidden")?!$.hasClass(d,"highlight")&&location.hash.slice(1)!=d.id?(this.highlight=d,$.addClass(d,"highlight")):$.hasClass(d,"op")||(this.highlightAnti=d,$.addClass(d,"highlight-anti")):b.show(a,d)):UA.hasCORS&&(c[1]||(c[1]=Main.board),b.cached[e=[c[1],c[2],c[3]].join("-")]?b.show(a,b.cached[e],!0):b.timeout=setTimeout(b.showRemote,b.debounce,a,c[1]||Main.board,c[2],c[3]))},showRemote:function(a,b,c,d){a.style.cursor="wait";$.get("//api.4chan.org/"+b+"/res/"+c+".json",{onload:function(){var e,f,g,k;a.style.cursor="";if(200==this.status||304==this.status||0==this.status){g=Parser.parseThreadJSON(this.responseText);for(e=0;f=g[e];++e)if(f.no==d){!Config.revealSpoilers&&g[0].custom_spoiler&&Parser.setCustomSpoiler(b,g[0].custom_spoiler);e=$.cls("post",Parser.buildHTMLFromJSON(f,b))[0];e.className="post preview";e.style.display="none";e.id="quote-preview";QuotePreview.cached[[b,c,d].join("-")]=e;!$.id("quote-preview")&&!QuotePreview.out&&(Config.IDColor&&(IDColor.boards[b]&&(k=$.cls("posteruid",e)[1]))&&IDColor.applyRemote(k.firstElementChild),document.body.appendChild(e),QuotePreview.show(a,e,!0));break}}else 404==this.status&&$.addClass(a,"deadlink")},onerror:function(){a.style.cursor=""}})},show:function(a,b,c){var d,e,f;c?(Parser.parsePost(b),b.style.display=""):(b=b.cloneNode(!0),location.hash&&location.hash=="#"+b.id&&(b.className+=" highlight"),b.id="quote-preview",b.className+=" preview");if(!a.parentNode.className&&(c=b.querySelectorAll("#"+$.cls("postMessage",b)[0].id+" > .quote .quotelink"),c[1])){f=">>"+a.parentNode.parentNode.id.split("_")[1];for(e=0;d=c[e];++e)if(d.textContent==f){$.addClass(d,"dotted");break}}c=a.getBoundingClientRect();d=document.documentElement.offsetWidth;e=b.style;document.body.appendChild(b);d-c.right<(0|0.3*d)?(d-=c.left,e.right=d+5+"px"):(d=c.left+c.width,e.left=d+5+"px");e.top=c.top+a.offsetHeight+(window.scrollY||window.pageYOffset)-b.offsetHeight/2-c.height/2+"px"},remove:function(a){var b,c;b=QuotePreview;b.out=!0;b.highlight?($.removeClass(b.highlight,"highlight"),b.highlight=null):b.highlightAnti&&($.removeClass(b.highlightAnti,"highlight-anti"),b.highlightAnti=null);clearTimeout(b.timeout);a.style.cursor="";(c=document.getElementById("quote-preview"))&&document.body.removeChild(c)}},ImageExpansion={expand:function(a){var b,c;Config.imageHover&&(b=$.id("image-hover"))&&document.body.removeChild(b);c=a.parentNode.getAttribute("href");if("pdf"!=c.slice(-3))if(a.setAttribute("data-expanding","1"),b=document.createElement("img"),b.alt="Image",b.className="fitToPage",b.setAttribute("src",c),b.style.display="none",a.parentNode.appendChild(b),UA.hasCORS)a.style.opacity="0.75",this.timeout=ImageExpansion.checkLoadStart(b,a);else this.onLoadStart(b,a)},contract:function(a){var b,c;clearTimeout(this.timeout);c=a.parentNode;b=c.parentNode.parentNode;$.removeClass(c.parentNode,"image-expanded");!Main.tid&&Config.threadHiding&&$.removeClass(c,"image-expanded-anti");c.firstChild.style.display="";c.removeChild(a);b.offsetTop<window.pageYOffset&&b.scrollIntoView()},toggle:function(a){a.hasAttribute("data-md5")?a.hasAttribute("data-expanding")||ImageExpansion.expand(a):ImageExpansion.contract(a)},onLoadStart:function(a,b){b.removeAttribute("data-expanding");$.addClass(b.parentNode.parentNode,"image-expanded");!Main.tid&&Config.threadHiding&&$.addClass(b.parentNode,"image-expanded-anti");a.style.display="";b.style.display="none"},checkLoadStart:function(a,b){if(a.naturalWidth)ImageExpansion.onLoadStart(a,b),b.style.opacity="";else return setTimeout(ImageExpansion.checkLoadStart,15,a,b)},onExpanded:function(){this.onload=this.onerror=null;this.style.opacity=1;$.addClass(this,"fitToPage")}},ImageHover={show:function(a){var b,c;c=a.parentNode.getAttribute("href");"pdf"!=c.slice(-3)&&(b=document.createElement("img"),b.id="image-hover",b.alt="Image",b.className="fitToScreen",b.setAttribute("src",c),document.body.appendChild(b),UA.hasCORS?(b.style.display="none",this.timeout=ImageHover.checkLoadStart(b,a)):b.style.left=a.getBoundingClientRect().right+10+"px")},hide:function(){var a;clearTimeout(this.timeout);(a=$.id("image-hover"))&&document.body.removeChild(a)},onLoadStart:function(a,b){var c;c=b.getBoundingClientRect();c=window.innerWidth-c.right;a.naturalWidth>c&&(a.style.maxWidth=c-20+"px");a.style.display=""},checkLoadStart:function(a,b){if(a.naturalWidth)ImageHover.onLoadStart(a,b);else return setTimeout(ImageHover.checkLoadStart,15,a,b)}},QR={init:function(){UA.hasFormData&&!Main.threadClosed&&(this.enabled=!0,this.cooldown=this.currentTid=null,this.auto=!1,this.sagePost=2,this.filePost=4,this.activeDelay=this.cdType=this.cdElapsed=0,"q"==Main.board?(this.baseDelay=60500,this.fileDelay=300500,this.sageDelay=600500):(this.fileDelay=this.baseDelay=30500,this.sageDelay=60500),this.captchaDelay=240500,this.xhr=this.pulse=this.captchaInterval=null,this.fileDisabled=!1,QR.purgeCooldown(),window.addEventListener("storage",this.syncStorage,!1))},lock:function(){QR.showPostError("This thread is closed.",!0)},toggleFileInput:function(a){if(a){if(this.fileDisabled=!0,a=$.id("qrFile"))a.setAttribute("disabled","disabled"),a.title="Image limit reached"}else if(this.fileDisabled=!1,a=$.id("qrFile"))a.removeAttribute("disabled"),a.title="Shift + Click to remove the file"},syncStorage:function(a){var b;a.key&&(b=a.key.split("-"),"4chan"==b[0]&&("cd"==b[1]&&a.newValue&&Main.board==b[2])&&QR.startCooldown(a.newValue))},quotePost:function(a){var b,c,d;d=$.tag("textarea",document.forms.qrPost)[0];b=d.selectionStart;if(!(UA.isOpera&&"string"==typeof(c=document.getSelection())))c=window.getSelection().toString();a=a?">>"+a+"\n":"";c&&(a+=">"+c.trim().replace(/[\r\n]+/g,"\n>")+"\n");d.value=d.value?d.value.slice(0,b)+a+d.value.slice(d.selectionEnd):a;UA.isOpera&&(b+=a.split("\n").length);d.selectionStart=d.selectionEnd=b+a.length;d.selectionStart==d.value.length&&(d.scrollTop=d.scrollHeight);d.focus()},show:function(a){var b,c,d,e,f,g,k,h,l,m,p,n;if(QR.currentTid)!Main.tid&&QR.currentTid!=a&&($.id("qrTid").textContent=$.id("qrResto").value=QR.currentTid=a,$.byName("com")[1].value="");else{QR.currentTid=a;e=$.id("postForm");d=document.createElement("div");d.id="quickReply";d.className="extPanel reply";d.setAttribute("data-trackpos","QR-position");Config["QR-position"]?d.style.cssText=Config["QR-position"]:(d.style.right="0px",d.style.top="50px");d.innerHTML='<div id="qrHeader" class="drag postblock">Quick Reply - Thread No.<span id="qrTid">'+a+'</span><img alt="X" src="'+Main.icons.cross+'" id="qrClose" class="extButton" title="Close Window"></div>';f=e.parentNode.cloneNode(!1);f.setAttribute("name","qrPost");f.innerHTML='<input type="hidden" value="'+$.byName("MAX_FILE_SIZE")[0].value+'" name="MAX_FILE_SIZE"><input type="hidden" value="regist" name="mode"><input id="qrResto" type="hidden" value="'+a+'" name="resto">';a=document.createElement("div");a.id="qrForm";g=e.firstElementChild.children;b=0;for(c=g.length-1;b<c;++b){k=document.createElement("div");if("captchaFormPart"==g[b].id){if(QR.noCaptcha)continue;k.innerHTML='<img id="qrCaptcha" title="Reload" width="300" height="57" src="'+$.id("recaptcha_image").firstChild.src+'" alt="reCAPTCHA challenge image"><input id="qrCapField" name="recaptcha_response_field" placeholder="reCAPTCHA Challenge (Required)" type="text" autocomplete="off"><input id="qrChallenge" name="recaptcha_challenge_field" type="hidden" value="'+
$.id("recaptcha_challenge_field").value+'">'}else if(m=g[b].firstElementChild.textContent,"Password"==m||"Spoilers"==m)continue;else if("File"==m)h=g[b].children[1].firstChild.cloneNode(!1),h.id="qrFile",h.size="19",QR.fileDisabled?(h.title="Image limit reached",h.setAttribute("disabled","disabled")):h.title="Shift + Click to remove the file",h.addEventListener("change",QR.checkCDType,!1),k.appendChild(h);else if(k.innerHTML=g[b].children[1].innerHTML,l="hidden"==k.firstChild.type?k.lastChild.previousSibling:k.firstChild,"INPUT"==l.nodeName||"TEXTAREA"==l.nodeName){if("name"==l.name&&(n=Main.getCookie("4chan_name")))l.value=n;else if("email"==l.name&&(l.id="qrEmail",l.addEventListener("change",QR.checkCDType,!1),n=Main.getCookie("4chan_email")))l.value=n;l.setAttribute("placeholder",m)}a.appendChild(k)}a.querySelector('input[type="submit"]').previousSibling.className="presubmit";e.querySelector('input[name="spoiler"]')&&(e=document.createElement("span"),e.id="qrSpoiler",e.innerHTML='<label>[<input type="checkbox" value="on" name="spoiler">Spoiler?]</label>',h.parentNode.insertBefore(e,h.nextSibling));$.tag("textarea",a)[0].addEventListener("keydown",QR.onKeyDown,!1);f.appendChild(a);d.appendChild(f);f=document.createElement("div");f.id="qrError";d.appendChild(f);d.addEventListener("click",QR.onClick,!1);document.body.appendChild(d);(p=localStorage.getItem("4chan-cd-"+Main.board))&&QR.startCooldown(p);Main.threadClosed&&QR.lock();QR.reloadCaptcha();Draggable.set($.id("qrHeader"))}},onKeyDown:function(a){if(a.ctrlKey&&83==a.keyCode){var b,c,d;a.stopPropagation();a.preventDefault();a=a.target;b=a.selectionStart;c=a.selectionEnd;a.value?(d="[spoiler]"+a.value.slice(b,c)+"[/spoiler]",a.value=a.value.slice(0,b)+d+a.value.slice(c),a.setSelectionRange(c+19,c+19)):(a.value="[spoiler][/spoiler]",a.setSelectionRange(9,9))}else 27==a.keyCode&&(!a.ctrlkey&&!a.altkey&&!a.shiftkey&&!a.metakey)&&QR.close()},close:function(){var a,b=$.id("quickReply");QR.currentTid=null;clearInterval(QR.captchaInterval);clearInterval(QR.pulse);QR.xhr&&(QR.xhr.abort(),QR.xhr=null);b.removeEventListener("click",QR.onClick,!1);(a=$.id("qrFile"))&&a.removeEventListener("change",QR.checkCDType,!1);(a=$.id("qrEmail"))&&a.removeEventListener("change",QR.checkCDType,!1);Draggable.unset($.id("qrHeader"));$.tag("textarea",b)[0].removeEventListener("keydown",QR.onKeyDown,!1);document.body.removeChild(b)},cloneCaptcha:function(){$.id("qrCaptcha").src=$.id("recaptcha_image").firstChild.src;$.id("qrChallenge").value=$.id("recaptcha_challenge_field").value;$.id("qrCapField").value=""},reloadCaptcha:function(a){var b,c;if(!QR.noCaptcha&&(c=$.id("recaptcha_image")))c.firstChild.setAttribute("data-loading","1"),poll=function(){clearTimeout(b);c.firstChild.hasAttribute("data-loading")?b=setTimeout(poll,100):(c.firstChild.setAttribute("data-loading","1"),QR.captchaInterval=setInterval(QR.cloneCaptcha,QR.captchaDelay),QR.cloneCaptcha(),a&&$.id("qrCapField").focus())},clearInterval(QR.captchaInterval),Recaptcha.reload("t"),b=setTimeout(poll,100)},checkCDType:function(){var a,b;QR.activeDelay=QR.cdType&QR.sagePost&&(b=$.id("qrEmail"))&&/sage/i.test(b.value)?QR.sageDelay:QR.cdType&QR.filePost&&(b=$.id("qrFile"))&&b.value?QR.fileDelay:QR.baseDelay;!QR.cooldown&&(a=QR.purgeCooldown())&&QR.startCooldown(a)},onClick:function(a){var b=a.target;if("submit"==b.type)a.preventDefault(),QR.submit(a.shiftKey);else switch(b.id){case"qrFile":a.shiftKey&&(a.preventDefault(),QR.resetFile());break;case"qrCaptcha":QR.reloadCaptcha(!0);break;case"qrClose":QR.close()}},showPostError:function(a,b){var c;c=$.id("qrError");c.innerHTML=a;c.style.display="block";!b&&(document.hidden||document.mozHidden||document.webkitHidden||document.msHidden)&&alert("Posting Error")},hidePostError:function(){$.id("qrError").style.display="none"},resetFile:function(){var a,b;b=document.createElement("input");b.id="qrFile";b.type="file";b.size="19";b.name="upfile";b.addEventListener("change",QR.checkCDType,!1);a=$.id("qrFile");a.removeEventListener("change",QR.checkCDType,!1);a.parentNode.replaceChild(b,a);QR.checkCDType()},submit:function(a){var b,c;QR.hidePostError();b=$.id("quickReply").querySelector('input[type="submit"]');QR.xhr?(QR.xhr.abort(),QR.xhr=null,QR.showPostError("Aborted"),b.value="Submit"):!a&&QR.cooldown?b.value=(QR.auto=!QR.auto)?QR.cooldown+"s (auto)":QR.cooldown+"s":(QR.auto=!1,!a&&(c=$.id("qrCapField"))&&""==c.value?(QR.showPostError("You forgot to type in the CAPTCHA."),c.focus()):(QR.xhr=new XMLHttpRequest,QR.xhr.open("POST",document.forms.qrPost.action,!0),QR.xhr.withCredentials=!0,QR.xhr.upload.onprogress=function(a){b.value=a.loaded>=a.total?"100%":(0|100*(a.loaded/a.total))+"%"},QR.xhr.onerror=function(){b.value="Submit";QR.xhr=null;QR.showPostError('Connection error. Are you <a href="https://www.4chan.org/banned">banned</a>?')},QR.xhr.onload=function(){var a,c,f;QR.xhr=null;b.value="Submit";if(200==this.status)if(a=this.responseText.match(/"errmsg"[^>]*>(.*?)<\/span/))QR.reloadCaptcha(),QR.showPostError(a[1]);else if(/heeding this warning/.test(this.responseText))a=this.responseText.split(/<br\/><br\/>\n<b>/)[1].split(/<\/b><br\/><br\/>/)[0],QR.showPostError("<h3>You were issued a warning:<h3>"+a),QR.reloadCaptcha();else{a=(c=$.id("qrFile"))&&c.value;f=1;if((c=$.id("qrEmail"))&&/sage/i.test(c.value))f|=QR.sagePost;a&&(f|=QR.filePost);f=Date.now()+"-"+f;localStorage.setItem("4chan-cd-"+Main.board,f);Main.tid&&ThreadUpdater.enabled&&setTimeout(ThreadUpdater.forceUpdate,500,!0);if(Config.persistentQR){QR.startCooldown(f);$.byName("com")[1].value="";$.byName("sub")[1].value="";if(c=$.byName("spoiler")[2])c.checked=!1;QR.reloadCaptcha();a&&QR.resetFile()}else Recaptcha.reload("t"),QR.close()}else QR.showPostError("Error: "+this.status+" "+this.statusText)},clearInterval(QR.pulse),b.value="Sending",QR.xhr.send(new FormData(document.forms.qrPost))))},purgeCooldown:function(){var a,b,c;if(a=localStorage.getItem("4chan-cd-"+Main.board))if(b=a.split("-"),c=parseInt(b[0],10),b=+b[1],b=b&QR.sagePost?QR.sageDelay:b&QR.filePost?QR.fileDelay:QR.baseDelay,Date.now()-c>=b)localStorage.removeItem("4chan-cd-"+Main.board);else return a},startCooldown:function(a){var b,c,d;if(!QR.noCooldown&&(c=$.id("quickReply"))&&!QR.xhr)clearInterval(QR.pulse),c=c.querySelector('input[type="submit"]'),a=a.split("-"),b=parseInt(a[0],10),QR.cdType=+a[1],QR.activeDelay=QR.cdType&QR.sagePost&&(d=$.id("qrEmail"))&&/sage/i.test(d.value)?QR.sageDelay:QR.cdType&QR.filePost&&(d=$.id("qrFile"))&&d.value?QR.fileDelay:QR.baseDelay,QR.cdElapsed=Date.now()-b,QR.cooldown=Math.floor((QR.activeDelay-QR.cdElapsed)/1E3),0>=QR.cooldown?QR.cooldown=!1:(c.value=QR.cooldown+"s",QR.pulse=setInterval(function(){QR.cdElapsed=Date.now()-b;QR.cooldown=Math.floor((QR.activeDelay-QR.cdElapsed)/1E3);0>=QR.cooldown?(clearInterval(QR.pulse),c.value="Submit",QR.cooldown=!1,QR.auto&&QR.submit()):c.value=QR.cooldown+(QR.auto?"s (auto)":"s")},1E3))}},ThreadHiding={init:function(){this.threshold=6048E5;this.hidden={};this.load()},toggle:function(a){$.id("sa"+a).hasAttribute("data-hidden")?this.show(a):this.hide(a);this.save()},show:function(a){var b;b=$.id("sa"+a);b.removeAttribute("data-hidden");b.firstChild.src=Main.icons.minus;$.removeClass($.id("t"+a),"post-hidden");delete this.hidden[a]},hide:function(a){var b,c;c=$.id("t"+a);Config.hideStubs?c.style.display=c.nextElementSibling.style.display="none":(b=$.id("sa"+a),b.setAttribute("data-hidden",a),b.firstChild.src=Main.icons.plus,c.className+=" post-hidden");this.hidden[a]=Date.now()},load:function(){var a;if(a=localStorage.getItem("4chan-hide-t-"+Main.board))this.hidden=JSON.parse(a)},purge:function(){var a,b;b=Date.now();for(a in this.hidden)b-this.hidden[a]>this.threshold&&delete this.hidden[a];this.save()},save:function(){for(var a in this.hidden){localStorage.setItem("4chan-hide-t-"+Main.board,JSON.stringify(this.hidden));return}localStorage.removeItem("4chan-hide-t-"+Main.board)}},ReplyHiding={init:function(){this.threshold=6048E5;this.hidden={};this.load()},toggle:function(a){$.id("sa"+a).hasAttribute("data-hidden")?this.show(a):this.hide(a);this.save()},show:function(a){var b;b=$.id("pc"+a);$.removeClass(b,"post-hidden");b=$.id("sa"+a);b.removeAttribute("data-hidden");b.firstChild.src=Main.icons.minus;delete this.hidden[a]},hide:function(a){var b;$.id("pc"+a).className+=" post-hidden";b=$.id("sa"+a);b.setAttribute("data-hidden",a);b.firstChild.src=Main.icons.plus;this.hidden[a]=Date.now()},load:function(){var a;if(a=localStorage.getItem("4chan-hide-r-"+Main.board))this.hidden=JSON.parse(a)},purge:function(){var a,b;b=Date.now();for(a in this.hidden)b-this.hidden[a]>this.threshold&&delete this.hidden[a];this.save()},save:function(){for(var a in this.hidden){localStorage.setItem("4chan-hide-r-"+
Main.board,JSON.stringify(this.hidden));return}localStorage.removeItem("4chan-hide-r-"+Main.board)}},ThreadWatcher={init:function(){var a;this.listNode=null;this.charLimit=45;this.watched={};this.isRefreshing=!1;a=document.createElement("div");a.id="threadWatcher";a.className="extPanel reply";a.setAttribute("data-trackpos","TW-position");Config["TW-position"]?a.style.cssText=Config["TW-position"]:(a.style.left="10px",a.style.top="380px");a.style.position=Config.fixedThreadWatcher?"fixed":"";a.innerHTML='<div class="drag" id="twHeader">Thread Watcher'+(UA.hasCORS?'<img id="twPrune" class="pointer right" src="'+Main.icons.refresh+'" alt="R" title="Refresh"></div>':"</div>");this.listNode=document.createElement("ul");this.listNode.id="watchList";this.load();this.refreshCurrent();this.build();a.appendChild(this.listNode);document.body.appendChild(a);a.addEventListener("mouseup",this.onClick,!1);Draggable.set($.id("twHeader"));window.addEventListener("storage",this.syncStorage,!1)},syncStorage:function(a){var b;a.key&&(b=a.key.split("-"),"4chan"==b[0]&&("watch"==b[1]&&a.newValue!=a.oldValue)&&(ThreadWatcher.load(),ThreadWatcher.build(!0)))},load:function(){if(storage=localStorage.getItem("4chan-watch"))this.watched=JSON.parse(storage)},build:function(a){var b,c,d,e;b="";for(d in this.watched)c=d.split("-"),b+='<li id="watch-'+d+'"><span class="pointer" data-cmd="unwatch" data-id="'+c[0]+'" data-board="'+c[1]+'">&times;</span> <a href="'+Main.linkToThread(c[0],c[1],this.watched[d][1])+'"',b=-1==this.watched[d][1]?b+' class="deadlink">':this.watched[d][2]?b+(' class="hasNewReplies">('+this.watched[d][2]+") "):b+">",b+="/"+c[1]+"/ - "+this.watched[d][0]+"</a></li>";if(a){c=$.cls("wbtn",$.id("delform"));for(a=0;e=c[a];++a)d=e.getAttribute("data-id")+"-"+Main.board,ThreadWatcher.watched[d]?e.hasAttribute("data-active")||(e.src=Main.icons.watched,e.setAttribute("data-active","1")):e.hasAttribute("data-active")&&(e.src=Main.icons.notwatched,e.removeAttribute("data-active"))}ThreadWatcher.listNode.innerHTML=b},onClick:function(a){a=a.target;a.hasAttribute("data-id")?ThreadWatcher.toggle(a.getAttribute("data-id"),a.getAttribute("data-board")):a.src&&!ThreadWatcher.isRefreshing&&ThreadWatcher.refresh()},toggle:function(a,b){var c,d,e,f;c=a+"-"+(b||Main.board);if(this.watched[c]){if(delete this.watched[c],c=$.id("wbtn-"+c))c.src=Main.icons.notwatched,c.removeAttribute("data-active")}else if(d=(d=$.cls("subject",$.id("pi"+a))[0].textContent)?d.slice(0,this.charLimit):(d=$.id("m"+a).innerHTML)?d.replace(/(?:<br>)+/g," ").replace(/<[^>]*?>/g,"").slice(0,this.charLimit):"No."+a,e=(f=$.id("t"+a)).children[1]?f.lastElementChild.id.slice(2):a,this.watched[c]=[d,e,0],c=$.id("wbtn-"+c))c.src=Main.icons.watched,c.setAttribute("data-active","1");this.save();this.load();this.build()},save:function(){localStorage.setItem("4chan-watch",JSON.stringify(ThreadWatcher.watched))},refresh:function(){var a,b,c,d,e;if(d=$.id("watchList").children.length)for(c in a=b=0,e=$.id("twPrune"),e.src=Main.icons.rotate,ThreadWatcher.isRefreshing=!0,ThreadWatcher.watched)setTimeout(ThreadWatcher.fetch,b,c,++a==d?e:null),b+=200},refreshCurrent:function(a){var b,c,d;b=Main.tid+"-"+Main.board;this.watched[b]&&(d=(c=$.id("t"+Main.tid)).children[1]?c.lastElementChild.id.slice(2):Main.tid,this.watched[b][1]!=d&&(this.watched[b][1]=d),this.watched[b][2]=0,this.save(),a&&this.build())},onRefreshEnd:function(a){a.src=Main.icons.refresh;this.isRefreshing=!1;this.save();this.load();this.build()},fetch:function(a,b){var c,d;c=$.id("watch-"+a);if(-1==ThreadWatcher.watched[a][1]){if(delete ThreadWatcher.watched[a],c.parentNode.removeChild(c),b)ThreadWatcher.onRefreshEnd(b)}else c=a.split("-"),d=new XMLHttpRequest,d.onload=function(){var c,d,g,k;if(200==this.status){g=Parser.parseThreadJSON(this.responseText);k=ThreadWatcher.watched[a][1];d=0;for(c=g.length-1;1<=c&&!(g[c].no<=k);c--)++d;d>ThreadWatcher.watched[a][2]&&(ThreadWatcher.watched[a][2]=d)}else 404==this.status&&(ThreadWatcher.watched[a][1]=-1);if(b)ThreadWatcher.onRefreshEnd(b)},b&&(d.onerror=d.onload),d.open("GET","//api.4chan.org/"+c[1]+"/res/"+
c[0]+".json"),d.send(null)}},ThreadExpansion={init:function(){this.enabled=UA.hasCORS},expandComment:function(a){var b,c,d,e,f,g,k,h;if(c=a.getAttribute("href").match(/^(?:res\/)([0-9]+)#p([0-9]+)$/))d=c[1],e=c[2],f=a.parentNode,f.textContent="Loading...",$.get("//api.4chan.org/"+Main.board+"/res/"+d+".json",{onload:function(){if(200==this.status){g=$.id("m"+e);h=Parser.parseThreadJSON(this.responseText);if(d==e)k=h[0].com;else for(b=h.length-1;0<b;b--)if(h[b].no==e){k=h[b].com;break}k?g.innerHTML=k:f.textContent="This post doesn't exist anymore."}else 404==this.status?f.textContent="This thread doesn't exist anymore.":(f.textContent="Connection Error",console.log("ThreadExpansion: "+this.status+" "+this.statusText))},onerror:function(){f.textContent="Connection Error";console.log("ThreadExpansion: xhr failed")}})},toggle:function(a){var b,c,d,e;b=$.id("t"+a);e=b.children[1];b.hasAttribute("data-truncated")&&(c=$.id("m"+a),d=c.nextSibling);$.hasClass(b,"tExpanded")?(b.className=b.className.replace(" tExpanded"," tCollapsed"),e.children[0].src=Main.icons.plus,e.children[1].style.display="inline",e.children[2].style.display="none",c&&(a=c.innerHTML,c.innerHTML=d.textContent,d.textContent=a)):$.hasClass(b,"tCollapsed")?(b.className=b.className.replace(" tCollapsed"," tExpanded"),e.children[0].src=Main.icons.minus,e.children[1].style.display="none",e.children[2].style.display="inline",c&&(a=c.innerHTML,c.innerHTML=d.textContent,d.textContent=a)):(e.children[0].src=Main.icons.rotate,ThreadExpansion.fetch(a))},fetch:function(a){$.get("//api.4chan.org/"+Main.board+"/res/"+a+".json",{onload:function(){var b,c,d,e,f,g,k,h;e=$.id("t"+a);h=e.children[1];if(200==this.status){f=+$.cls("reply",e)[0].id.slice(1);g=Parser.parseThreadJSON(this.responseText);!Config.revealSpoilers&&g[0].custom_spoiler&&Parser.setCustomSpoiler(Main.board,g[0].custom_spoiler);d=document.createDocumentFragment();for(b=1;c=g[b];++b)if(c.no<f)c=Parser.buildHTMLFromJSON(c,Main.board),c.className+=" rExpanded",d.appendChild(c);else break;f=$.id("m"+a);if((k=$.cls("abbr",f)[0])&&/^Comment/.test(k.textContent))e.setAttribute("data-truncated","1"),k=document.createElement("div"),k.style.display="none",k.textContent=f.innerHTML,f.parentNode.insertBefore(k,f.nextSibling),(k=$.cls("capcodeReplies",f)[0])?(f.innerHTML=g[0].com+"<br><br>",f.appendChild(k)):f.innerHTML=g[0].com;e.insertBefore(d,h.nextSibling);Parser.parseThread(a,1,b-1);e.className+=" tExpanded";h.children[0].src=Main.icons.minus;h.children[1].style.display="none";h.children[2].style.display="inline"}else 404==this.status?(h.children[0].src=Main.icons.plus,h.children[0].display="none",h.children[1].textContent="This thread doesn't exist anymore."):(h.children[0].src=Main.icons.plus,console.log("ThreadExpansion: "+this.status+" "+this.statusText))},onerror:function(){$.id("t"+a).children[1].children[0].src=Main.icons.plus;console.log("ThreadExpansion: xhr failed")}})}},ThreadUpdater={init:function(){UA.hasCORS&&(this.enabled=!0,this.pageTitle=document.title,this.unreadCount=0,this.auto=!1,this.delayId=0,this.delayIdHidden=4,this.delayRange=[10,15,20,30,60,90,120,180,240,300],this.timeLeft=0,this.interval=null,this.lastModified="0",this.lastReply=null,this.iconNode=document.head.querySelector('link[rel="shortcut icon"]'),this.iconNode.type="image/x-icon",this.defaultIcon=this.iconNode.getAttribute("href"),document.hidden||("mozHidden"in document?(this.hidden="mozHidden",this.visibilitychange="mozvisibilitychange"):"webkitHidden"in document?(this.hidden="webkitHidden",this.visibilitychange="webkitvisibilitychange"):"msHidden"in document&&(this.hidden="msHidden",this.visibilitychange="msvisibilitychange")),this.initControls(),sessionStorage.getItem("4chan-auto-"+Main.tid)&&this.start())},initControls:function(){var a,b,c,d,e,f;for(a=0;2>a;++a)b=a?"":"Bot",c=document.createDocumentFragment(),c.appendChild(document.createTextNode(" [")),d=document.createElement("a"),d.href="",d.textContent="Update",d.setAttribute("data-cmd","update"),c.appendChild(d),c.appendChild(document.createTextNode("]")),c.appendChild(document.createTextNode(" [")),e=document.createElement("label"),d=document.createElement("input"),d.type="checkbox",d.title="Fetch new replies automatically",d.setAttribute("data-cmd","auto"),this["autoNode"+b]=d,e.appendChild(d),e.appendChild(document.createTextNode("Auto")),c.appendChild(e),c.appendChild(document.createTextNode("] ")),c.appendChild(this["statusNode"+b]=document.createElement("span")),(f=$.cls("navLinks"+b)[0])&&f.appendChild(c)},start:function(){this.auto=!0;this.autoNode.checked=this.autoNodeBot.checked=!0;this.force=this.updating=this.fromQR=!1;this.lastUpdated=Date.now();this.hidden&&document.addEventListener(this.visibilitychange,this.onVisibilityChange,!1);document.addEventListener("scroll",this.onScroll,!1);this.delayId=0;this.timeLeft=this.delayRange[0];this.pulse();sessionStorage.setItem("4chan-auto-"+Main.tid,1)},stop:function(a){clearTimeout(this.interval);this.auto=this.updating=this.force=this.fromQR=!1;this.autoNode.checked=this.autoNodeBot.checked=!1;this.hidden&&document.removeEventListener(this.visibilitychange,this.onVisibilityChange,!1);a&&(this.setStatus(""),this.setIcon(this.defaultIcon));sessionStorage.removeItem("4chan-auto-"+Main.tid)},pulse:function(){var a=ThreadUpdater;0==a.timeLeft?a.update():(a.setStatus(a.timeLeft--),a.interval=setTimeout(a.pulse,1E3))},adjustDelay:function(a){0==a?this.force||this.delayId<this.delayRange.length-1&&++this.delayId:this.delayId=document[this.hidden]?this.delayIdHidden:0;this.timeLeft=this.delayRange[this.delayId];this.auto&&this.pulse()},onVisibilityChange:function(){var a;a=ThreadUpdater;Date.now();a.delayId=document[a.hidden]&&a.delayId<a.delayIdHidden?a.delayIdHidden:0;a.timeLeft=a.delayRange[0];a.lastUpdated=Date.now();clearTimeout(a.interval);a.pulse()},onScroll:function(){var a;document.documentElement.scrollHeight==document.documentElement.clientHeight+window.scrollY&&(a=ThreadUpdater,a.dead||a.setIcon(a.defaultIcon),a.unreadCount=0,document.title=a.pageTitle,a.lastReply&&($.removeClass(a.lastReply,"newPostsMarker"),a.lastReply=null))},forceUpdate:function(a){ThreadUpdater.force=!0;ThreadUpdater.fromQR=a;ThreadUpdater.update()},toggleAuto:function(){this.updating||(this.auto?this.stop(!0):this.start())},update:function(){var a;Date.now();a=ThreadUpdater;a.updating||(clearTimeout(a.interval),a.updating=!0,a.setStatus("Updating..."),$.get("//api.4chan.org/"+Main.board+"/res/"+Main.tid+".json",{onload:a.onload,onerror:a.onerror},{"If-Modified-Since":a.lastModified}))},markDeletedReplies:function(a){var b,c,d,e;d={};for(b=0;c=a[b];++b)d["p"+c.no]=1;a=$.cls("post");for(b=0;c=a[b];++b)!d[c.id]&&(!c.hasAttribute("data-pfx")&&!$.hasClass(c,"deleted"))&&(e=document.createElement("img"),e.src=Main.icons2.trash,e.className="trashIcon",e.title="This post has been deleted",$.addClass(c,"deleted"),$.cls("postNum",c)[1].appendChild(e))},onload:function(){var a,b,c,d,e,f,g;b=ThreadUpdater;c=[];b.setStatus("");if(200==this.status){b.lastModified=this.getResponseHeader("Last-Modified");d=$.id("t"+Main.tid);f=d.children[d.childElementCount-
1];g=+f.id.slice(2);e=Parser.parseThreadJSON(this.responseText);a=!!e[0].closed;a!=Main.threadClosed&&(QR.enabled&&$.id("quickReply")&&(a?QR.lock():QR.hidePostError()),Main.setThreadState("closed",a));a=!!e[0].sticky;a!=Main.threadSticky&&Main.setThreadState("sticky",a);a=!!e[0].imagelimit;QR.enabled&&a!=QR.fileDisabled&&($.id("quickReply")&&QR.toggleFileInput(a),QR.fileDisabled=a);!Config.revealSpoilers&&e[0].custom_spoiler&&Parser.setCustomSpoiler(Main.board,e[0].custom_spoiler);b.markDeletedReplies(e);for(a=e.length-1;0<=a&&!(e[a].no<=g);a--)c.push(e[a]);if(c[0]){b.force?b.fromQR||b.setStatus(c.length+" new post"+(1<c.length?"s":"")):(!b.lastReply&&g!=Main.tid&&((b.lastReply=f.lastChild).className+=" newPostsMarker"),0==b.unreadCount&&b.setIcon(b.icons[Main.type]),b.unreadCount+=c.length,document.title="("+b.unreadCount+") "+b.pageTitle);b.fromQR=!1;f=document.createDocumentFragment();for(a=c.length-1;0<=a;a--)f.appendChild(Parser.buildHTMLFromJSON(c[a],Main.board));d.appendChild(f);Parser.parseThread(d.id.slice(1),-c.length);Config.threadWatcher&&ThreadWatcher.refreshCurrent(!0);Config.threadStats&&(d=e[0],ThreadStats.update(d.replies,d.images,d.bumplimit,d.imagelimit))}else b.setStatus("No new posts")}else if(304==this.status||0==this.status)b.setStatus("No new posts");else if(404==this.status){b.setIcon(b.icons[Main.type+"dead"]);b.setError("This thread has been pruned or deleted");b.dead=!0;b.stop();return}b.lastUpdated=Date.now();b.adjustDelay(c.length);b.updating=b.force=!1},onerror:function(){var a=ThreadUpdater;UA.isOpera&&!this.statusText&&0==this.status?a.setStatus("No new posts"):a.setError("Connection Error");a.lastUpdated=Date.now();a.adjustDelay(0);a.updating=a.force=!1},setStatus:function(a){this.statusNode.textContent=this.statusNodeBot.textContent=a},setError:function(a){this.statusNode.innerHTML=this.statusNodeBot.innerHTML='<span class="tu-error">'+a+"</span>"},setIcon:function(a){this.iconNode.href=a;document.head.appendChild(this.iconNode)},icons:{ws:"//static.4chan.org/image/favicon-ws-newposts.ico",nws:"//static.4chan.org/image/favicon-nws-newposts.ico",wsdead:"//static.4chan.org/image/favicon-ws-deadthread.ico",nwsdead:"//static.4chan.org/image/favicon-nws-deadthread.ico"}},ThreadStats={init:function(){var a;this.nodeTop=document.createElement("div");this.nodeTop.className="thread-stats";this.nodeBot=this.nodeTop.cloneNode(!1);a=$.cls("navLinks");a[0]&&a[0].appendChild(this.nodeTop);a[3]&&a[3].appendChild(this.nodeBot);this.update()},update:function(a,b,c,d){void 0===a&&(a=$.cls("replyContainer").length,b=$.cls("fileText").length-($.id("fT"+Main.tid)?1:0));a=a+" repl"+(1<a||!a?"ies":"y");b=b+" image"+(1<b||!b?"s":"");c&&(a='<em title="Bump limit reached">'+a+"</em>");d&&(b='<em title="Image limit reached" >'+b+"</em>");this.nodeTop.innerHTML=this.nodeBot.innerHTML="["+a+"] ["+b+"]"}},Filter={init:function(){this.entities=document.createElement("div");Filter.load()},onClick:function(a){var b;if(b=a.target.getAttribute("data-cmd"))switch(b){case"filters-add":Filter.add();break;case"filters-save":Filter.save();Filter.close();break;case"filters-close":Filter.close();break;case"filters-del":Filter.remove(a.target.parentNode.parentNode);break;case"filters-help-open":Filter.openHelp();break;case"filters-help-close":Filter.closeHelp()}},exec:function(a,b,c,d,e){var f,g,k,h,l=Filter.activeFilters,m=!1;for(i=0;h=l[i];++i)if(0==h.type){if((f||(f=c.getElementsByClassName("postertrip")[0]))&&h.pattern==f.textContent){m=!0;break}}else if(1==h.type){if((g||(g=c.getElementsByClassName("name")[0]))&&h.pattern==g.textContent){m=!0;break}}else if(k||(this.entities.innerHTML=d.innerHTML.replace(/<br>/g,"\n").replace(/[<[^>]+>/g,""),k=this.entities.textContent),h.pattern.test(k)){m=!0;break}if(m){if(h.hide)return a.className+=" post-hidden",el=document.createElement("span"),e?el.innerHTML='[<a data-filtered="1" href="res/'+e+'">View</a>]':(el.textContent="[View]",el.setAttribute("data-filtered","1")),el.className="filter-preview",b.appendChild(el),!0;a.className+=" filter-hl";a.style.boxShadow="-3px 0 "+h.color}return!1},load:function(){var a,b,c,d,e,f,g,k,h,l;this.activeFilters=[];if(c=localStorage.getItem("4chan-filters")){c=JSON.parse(c);f=RegExp("(\\/|\\.|\\*|\\+|\\?|\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");g=/^\/(.*)\/(i?)$/;l=/\\\*/g;try{for(e=0;b=c[e];++e)if(b.active&&""!=b.pattern){d=b.pattern;if(!b.type||1==b.type)pattern=d;else if(match=d.match(g))pattern=RegExp(match[1],match[2]);else if('"'==d[0]&&'"'==d[d.length-1])pattern=RegExp(d.slice(1,-1).replace(f,"\\$1"));else{k=d.split(" ");pattern="";a=0;for(j=k.length;a<j;++a)h=k[a].replace(f,"\\$1").replace(l,"[^\\s]*"),pattern+="(?=.*\\b"+h+"\\b)";pattern=RegExp("^"+pattern,"im")}this.activeFilters.push({type:b.type,pattern:pattern,color:b.color,hide:b.hide})}}catch(m){alert("There was an error processing one of the filters: "+m+" in: "+d)}}},openHelp:function(){var a;$.id("filtersHelp")||(a=document.createElement("div"),a.id="filtersHelp",a.className="UIPanel",a.setAttribute("data-cmd","filters-help-close"),a.innerHTML='<div class="extPanel reply"><div class="panelHeader">Filters &amp; Highlights Help<span><img alt="Close" title="Close" class="pointer" data-cmd="filters-help-close" src="'+
Main.icons.cross+'"></span></div><h4>Tripcode and Name filters:</h4><ul><li>Those use simple string comparison.</li><li>Type them exactly as they appear on 4chan, including the exclamation mark for tripcode filters.</li><li>Example: <code>!Ep8pui8Vw2</code></li></ul><h4>Comment filters:</h4><ul><li><strong>Matching whole words:</strong></li><li><code>feel</code> &mdash; will match <em>"feel"</em> but not <em>"feeling"</em>. This search is case-insensitive.</li></ul><ul><li><strong>AND operator:</strong></li><li><code>feel girlfriend</code> &mdash; will match <em>"feel"</em> AND <em>"girlfriend"</em> in any order.</li></ul><ul><li><strong>Exact match:</strong></li><li><code>"that feel when"</code> &mdash; place double quotes around the pattern to search for an exact string</li></ul><ul><li><strong>Wildcards:</strong></li><li><code>feel*</code> &mdash; matches expressions such as <em>"feel"</em>, <em>"feels"</em>, <em>"feeling"</em>, <em>"feeler"</em>, etc\u2026</li><li><code>idolm*ster</code> &mdash; this can match <em>"idolmaster"</em> or <em>"idolm@ster"</em>, etc\u2026</li></ul><ul><li><strong>Regular expressions:</strong></li><li><code>/feel when no (girl|boy)friend/i</code></li><li><code>/^(?!.*touhou).*$/i</code> &mdash; NOT operator.</li><li><code>/^>/</code> &mdash; comments starting with a quote.</li><li><code>/^$/</code> &mdash; comments with no text.</li></ul><h4>Colors:</h4><ul><li>The color field can accept any valid CSS color:</li><li><code>red</code>, <code>#0f0</code>, <code>#00ff00</code>, <code>rgba( 34, 12, 64, 0.3)</code>, etc\u2026</li></ul>',document.body.appendChild(a),a.addEventListener("click",this.onClick,!1))},closeHelp:function(){var a;if(a=$.id("filtersHelp"))a.removeEventListener("click",this.onClick,!1),document.body.removeChild(a)},open:function(){var a,b,c,d,e;if(!$.id("filtersMenu")){c=document.createElement("div");c.id="filtersMenu";c.className="UIPanel";c.style.display="none";c.setAttribute("data-cmd","filters-close");c.innerHTML='<div class="extPanel reply"><div class="panelHeader">Filters &amp; Highlights<span><img alt="Help" class="pointer" title="Help" data-cmd="filters-help-open" src="'+
Main.icons.help+'"><img alt="Close" title="Close" class="pointer" data-cmd="filters-close" src="'+Main.icons.cross+'"></span></div><table><thead><tr><th>On</th><th>Pattern</th><th>Type</th><th>Color</th><th>Hide</th><th>Del</th></tr></thead><tbody id="filter-list"></tbody><tfoot><tr><td colspan="6"><button data-cmd="filters-add">Add</button><button class="right" data-cmd="filters-save">Save</button></td></tr></tfoot></table></div>';document.body.appendChild(c);c.addEventListener("click",this.onClick,!1);e=$.id("filter-list");if(d=localStorage.getItem("4chan-filters")){d=JSON.parse(d);for(a=0;b=d[a];++a)e.appendChild(this.buildEntry(b,a))}c.style.display=""}},close:function(){var a;if(a=$.id("filtersMenu"))a.removeEventListener("click",this.onClick,!1),document.body.removeChild(a)},add:function(){$.id("filter-list").appendChild(this.buildEntry({active:!0,type:0,pattern:"",color:"",hide:!1}))},remove:function(a){$.id("filter-list").removeChild(a)},save:function(){var a,b,c,d;b=[];c=$.id("filter-list").children;for(a=0;d=c[a];++a)b.push({active:d.children[0].firstChild.checked,pattern:d.children[1].firstChild.value,type:d.children[2].firstChild.selectedIndex,color:d.children[3].firstChild.value,hide:d.children[4].firstChild.checked});b[0]?localStorage.setItem("4chan-filters",JSON.stringify(b)):localStorage.removeItem("4chan-filters")},buildEntry:function(a){var b,c,d;b=document.createElement("tr");c='<td><input type="checkbox"'+(a.active?' checked="checked"></td>':"></td>");c+='<td><input class="fPattern" type="text" value="'+
a.pattern.replace(/"/g,"&quot;")+'"></td>';d=["","",""];d[a.type]='selected="selected"';c+='<td><select size="1"><option value="0"'+d[0]+'>Tripcode</option><option value="1"'+d[1]+'>Name</option><option value="2"'+d[2]+">Comment</option></select></td>";c+='<td><input type="text" class="fColor" value="'+a.color+'"></td>';c+='<td><input type="checkbox"'+(a.hide?' checked="checked"></td>':"></td>");b.innerHTML=c+'<td><span data-cmd="filters-del" class="pointer fDel">&times;</span></td>';return b}},IDColor={css:"padding: 0 5px; border-radius: 6px; font-size: 0.8em;",boards:{q:!0,b:!0,soc:!0},ids:{},init:function(){var a;this.boards[Main.board]&&(this.enabled=!0,a=document.createElement("style"),a.setAttribute("type","text/css"),a.textContent=".posteruid .hand {"+this.css+"}",document.head.appendChild(a))},compute:function(a){var b,c;b=[];c=$.hash(a);b[0]=c>>24&255;b[1]=c>>16&255;b[2]=c>>8&255;b[3]=125<0.299*b[0]+0.587*b[1]+0.114*b[2];return this.ids[a]=b},apply:function(a){var b;b=IDColor.ids[a.textContent]||IDColor.compute(a.textContent);a.style.cssText="    background-color: rgb("+b[0]+","+b[1]+","+b[2]+");    color: "+(b[3]?"black;":"white;")},applyRemote:function(a){this.apply(a);a.style.cssText+=this.css}},Media={init:function(){this.active=!0;this.debounce=!1;this.limit=3;this.embeds={};this.matchSC=/(?:http:\/\/)?soundcloud\.com\/[^\s<]+/g;this.nodesSC=[];this.testYT=/youtube\.com|youtu\.be/g;this.matchYT=/(?:https?:\/\/)?(?:www\.youtube\.com\/watch\?(?:[^\s]*?)v=|youtu\.be\/)([a-zA-Z0-9_-]{11})[^\s<]*/g;this.nodesYT=[]},clearDebounce:function(){Media.debounce=!1},checkEmbeds:function(){var a,b,c,d,e;if(!Media.debounce){e=document.documentElement.clientHeight+window.scrollY;if(Config.embedSoundCloud){dHeight=document.documentElement.offsetHeight-Media.baseHeight;d=Media.nodesSC;for(a=d.length-1;(c=d[a])&&c[0]+dHeight<e;){for(b=0;c[2][b];++b)Media.embedSoundCloud(c[1],c[2][b]);d.length--;a--}}if(Config.embedYouTube){dHeight=document.documentElement.offsetHeight-Media.baseHeight;d=Media.nodesYT;for(a=d.length-1;(c=d[a])&&c[0]+dHeight<e;){for(b=0;c[2][b];++b)Media.embedYouTube(c[1],c[2][b]);d.length--;a--}}Media.debounce=!0;setTimeout(Media.clearDebounce,250)}},finalize:function(){this.active&&(this.baseHeight=document.documentElement.offsetHeight,window.addEventListener("scroll",Media.checkEmbeds,!1),this.nodesSC[1]&&this.nodesSC.reverse(),this.nodesYT[1]&&this.nodesYT.reverse())},parseSoundCloud:function(a){var b;if((b=a.innerHTML.match(this.matchSC))&&b.length<=this.limit)this.active||(this.active=!0),this.nodesSC.push([a.getBoundingClientRect().top,a,b])},embedSoundCloud:function(a,b){var c;Media.embeds[b]||(Media.embeds[b]=!0,c=new XMLHttpRequest,c.open("GET","http://soundcloud.com/oembed?show_artwork=false&&maxwidth=500px&show_comments=false&format=json&url="+("h"!=b.charAt(0)?"http://"+b:b)),c.onload=function(){if(200==this.status||304==this.status)a.innerHTML=a.innerHTML.replace(b,JSON.parse(this.responseText).html)},c.send(null))},parseYouTube:function(a){var b,c;if((b=a.innerHTML.match(this.testYT))&&b.length<=this.limit){this.active||(this.active=!0);for(b=[];c=this.matchYT.exec(a.innerHTML);)b.push(c);this.nodesYT.push([a.getBoundingClientRect().top,a,b])}},embedYouTube:function(a,b){var c,d;c=b[0];d=b[1];Media.embeds[d]||(Media.embeds[d]=!0,a.innerHTML=a.innerHTML.replace(c,'<iframe width="640" height="360" src="//www.youtube.com/embed/'+encodeURIComponent(d)+'" frameborder="0" allowfullscreen></iframe>'))}},CustomCSS={init:function(){var a,b;if(b=localStorage.getItem("4chan-css"))a=document.createElement("style"),a.id="customCSS",a.setAttribute("type","text/css"),a.textContent=b,document.head.appendChild(a)},open:function(){var a;$.id("customCSSMenu")||(a=document.createElement("div"),a.id="customCSSMenu",a.className="UIPanel",a.setAttribute("data-cmd","css-close"),a.innerHTML='<div class="extPanel reply"><div class="panelHeader">Custom CSS<span><img alt="Close" title="Close" class="pointer" data-cmd="css-close" src="'+Main.icons.cross+'"></span></div><textarea id="customCSSBox">'+(localStorage.getItem("4chan-css")||"")+'</textarea><div class="center"><button data-cmd="css-save">Save CSS</button></div></td></tr></tfoot></table></div>',document.body.appendChild(a),a.addEventListener("click",this.onClick,!1))},save:function(){var a,b;if(a=$.id("customCSSBox"))if(localStorage.setItem("4chan-css",a.value),Config.customCSS&&(b=$.id("customCSS")))document.head.removeChild(b),CustomCSS.init()},close:function(){var a;if(a=$.id("customCSSMenu"))a.removeEventListener("click",this.onClick,!1),document.body.removeChild(a)},onClick:function(a){if(a=a.target.getAttribute("data-cmd"))switch(a){case"css-close":CustomCSS.close();break;case"css-save":CustomCSS.save(),CustomCSS.close()}}},Keybinds={init:function(){this.map={65:function(){ThreadUpdater.enabled&&ThreadUpdater.toggleAuto()},81:function(){QR.enabled&&Main.tid&&(QR.show(Main.tid),QR.quotePost())},82:function(){ThreadUpdater.enabled&&ThreadUpdater.forceUpdate()},66:function(){var a;(a=$.cls("prev")[0])&&(a=$.tag("form",a)[0])&&a.submit()},78:function(){var a;(a=$.cls("next")[0])&&(a=$.tag("form",a)[0])&&a.submit()},73:function(){location.href="/"+Main.board+"/"}};document.addEventListener("keyup",this.resolve,!1)},resolve:function(a){var b;b=a.target;if(!("TEXTAREA"==b.nodeName||"INPUT"==b.nodeName))if(b=Keybinds.map[a.keyCode])if(b[1]||a[b[1]])b[0]();else!a.altKey&&(!a.shiftKey&&!a.ctrlKey&&!a.metaKey)&&b()},open:function(){var a;$.id("keybindsHelp")||(a=document.createElement("div"),a.id="keybindsHelp",a.className="UIPanel",a.setAttribute("data-cmd","keybinds-close"),a.innerHTML='<div class="extPanel reply"><div class="panelHeader">Keyboard Shortcuts<span><img data-cmd="keybinds-close" class="pointer" alt="Close" title="Close" src="'+Main.icons.cross+'"></span></div><ul><li><strong>Global</strong></li><li><kbd>A</kbd> &mdash; Toggle auto-updater</li><li><kbd>Q</kbd> &mdash; Open Quick Reply</li><li><kbd>R</kbd> &mdash; Update thread</li><li><kbd>B</kbd> &mdash; Previous page</li><li><kbd>N</kbd> &mdash; Next page</li><li><kbd>I</kbd> &mdash; Return to index</li></ul><ul><li><strong>Quick Reply (always enabled)</strong></li><li><kbd>Ctrl + Click</kbd> the post number &mdash; Quote without linking</li><li><kbd>Ctrl + S</kbd> &mdash; Spoiler tags</li><li><kbd>Esc</kbd> &mdash; Close the Quick Reply</li></ul>',document.body.appendChild(a),a.addEventListener("click",this.onClick,!1))},close:function(){var a;if(a=$.id("keybindsHelp"))a.removeEventListener("click",this.onClick,!1),document.body.removeChild(a)},onClick:function(a){var b;(b=a.target.getAttribute("data-cmd"))&&"keybinds-close"==b&&Keybinds.close()}},Draggable={el:null,key:null,scrollX:null,scrollY:null,dx:null,dy:null,right:null,bottom:null,set:function(a){a.addEventListener("mousedown",Draggable.startDrag,!1)},unset:function(a){a.removeEventListener("mousedown",Draggable.startDrag,!1)},startDrag:function(a){var b,c,d;if(!this.parentNode.hasAttribute("data-shiftkey")||a.shiftKey)a.preventDefault(),b=Draggable,c=document.documentElement,b.el=this.parentNode,b.key=b.el.getAttribute("data-trackpos"),d=b.el.getBoundingClientRect(),b.dx=a.clientX-d.left,b.dy=a.clientY-d.top,b.right=c.clientWidth-d.width,b.bottom=c.clientHeight-d.height,"fixed"!=getComputedStyle(b.el,null).position?(b.scrollX=window.scrollX||window.pageXOffset,b.scrollY=window.scrollY||window.pageYOffset):b.scrollX=b.scrollY=0,document.addEventListener("mouseup",b.endDrag,!1),document.addEventListener("mousemove",b.onDrag,!1)},endDrag:function(){document.removeEventListener("mouseup",Draggable.endDrag,!1);document.removeEventListener("mousemove",Draggable.onDrag,!1);Draggable.key&&(Config[Draggable.key]=Draggable.el.style.cssText,Config.save());delete Draggable.el},onDrag:function(a){var b,c;b=a.clientX-Draggable.dx+Draggable.scrollX;a=a.clientY-Draggable.dy+Draggable.scrollY;c=Draggable.el.style;1>b?(c.left="0",c.right=""):Draggable.right<b?(c.left="",c.right="0"):(c.left=100*(b/document.documentElement.clientWidth)+"%",c.right="");1>a?(c.top="0",c.bottom=""):Draggable.bottom<a?(c.bottom="0",c.top=""):(c.top=100*(a/document.documentElement.clientHeight)+"%",c.bottom="")}},UA={init:function(){document.head=document.head||$.tag("head")[0];this.isOpera="[object Opera]"==Object.prototype.toString.call(window.opera);this.hasCORS="withCredentials"in new XMLHttpRequest;this.hasFormData="FormData"in
window;var a;try{new window.CustomEvent("e"),a=!0}catch(b){a=!1}this.hasCustomEventCtor=a}},Config={quotePreview:!0,backlinks:!0,quickReply:!0,threadUpdater:!0,threadHiding:!0,pageTitle:!0,hideGlobalMsg:!0,threadWatcher:!1,imageExpansion:!1,threadExpansion:!1,imageSearch:!1,reportButton:!1,localTime:!1,topPageNav:!1,stickyNav:!1,keyBinds:!1,inlineQuotes:!1,filter:!1,revealSpoilers:!1,replyHiding:!1,imageHover:!1,threadStats:!1,IDColor:!1,downloadFile:!1,embedYouTube:!1,embedSoundCloud:!1,customCSS:!1,hideStubs:!1,compactThreads:!1,dropDownNav:!1,fixedThreadWatcher:!1,persistentQR:!1,disableAll:!1,load:function(){(storage=localStorage.getItem("4chan-settings"))?(storage=JSON.parse(storage),$.extend(Config,storage)):Main.firstRun=!0},loadFromURL:function(){var a,b;a=location.hash.split("=",2);if("#cfg"==a[0])try{return b=JSON.parse(decodeURIComponent(a[1])),history.replaceState(null,"",location.href.split("#",1)[0]),$.extend(Config,JSON.parse(b.settings)),Config.save(),b.filters&&localStorage.setItem("4chan-filters",b.filters),b.css&&localStorage.setItem("4chan-css",b.css),!0}catch(c){console.log(c)}return!1},toURL:function(){var a,b={};b.settings=localStorage.getItem("4chan-settings");if(a=localStorage.getItem("4chan-filters"))b.filters=a;if(a=localStorage.getItem("4chan-css"))b.css=a;return encodeURIComponent(JSON.stringify(b))},save:function(){localStorage.setItem("4chan-settings",JSON.stringify(Config))}},SettingsMenu={options:{Essential:{quotePreview:["Quote preview","Enable inline quote previews"],backlinks:["Backlinks","Show who has replied to a post"],quickReply:["Quick reply","Enable inline reply box"],threadUpdater:["Thread updater","Enable inline thread updating"],threadHiding:["Thread hiding","Enable thread hiding"],pageTitle:["Excerpts in page title","Show post subjects or comment excerpts in page title"],hideGlobalMsg:["Enable announcement hiding","Enable announcement hiding (will reset on new or updated announcements)"]},Recommended:{threadWatcher:["Thread watcher","Enable thread watcher"],imageExpansion:["Image expansion","Enable inline image expansion, limited to browser width"],threadExpansion:["Thread expansion","Enable inline thread expansion"],imageSearch:["Image search","Add Google and iqdb image search buttons next to image posts"],reportButton:["Report button","Add a report button next to posts for easy reporting"],localTime:["Convert dates to local time","Convert 4chan server time (US Eastern Time) to your local time"],topPageNav:["Page navigation at the top","Show the page switcher at the top of the page, hold Shift and drag to move"],stickyNav:["Navigation arrows","Show top and bottom navigation arrows, hold Shift and drag to move"],keyBinds:['Use keyboard shortcuts [<a href="javascript:;" data-cmd="keybinds-open">Show</a>]',"Enable handy keyboard shortcuts for common actions"]},Advanced:{filter:['Filters &amp; Highlights [<a href="javascript:;" data-cmd="filters-open">Edit</a>]',"Enable pattern-based filters"],revealSpoilers:["Don't spoiler images","Don't replace spoiler images with a placeholder and show filenames"],replyHiding:["Reply hiding","Enable reply hiding"],inlineQuotes:["Inline quote links","Clicking quote links will inline expand the quoted post, shift-clicking bypasses the inlining"],imageHover:["Image hover","Expand images on hover, limited to browser size"],threadStats:["Thread statistics","Display post and image counts at the top and bottom right of the page"],IDColor:["Color user IDs","Assign unique colors to user IDs on boards that use them"],downloadFile:["Download original","Adds a button to download image with original filename (Chrome only)"],embedYouTube:["Embed YouTube links","Embed YouTube player into replies"],embedSoundCloud:["Embed SoundCloud links","Embed SoundCloud player into replies"]},Customization:{customCSS:['Custom CSS [<a href="javascript:;" data-cmd="css-open">Edit</a>]',"Embed your own CSS rules"],hideStubs:["Hide thread stubs","Don't display stubs of hidden threads"],compactThreads:["Force long posts to wrap","Long posts will wrap at 75% screen width"],dropDownNav:["Use drop-down navigation","Use persistent drop-down navigation bar instead of traditional links"],fixedThreadWatcher:["Pin thread watcher","Pin the thread watcher to the page"],persistentQR:["Persistent quick reply","Keep quick reply window open after posting"]}},save:function(){var a,b,c,d;b=$.id("settingsMenu").getElementsByClassName("menuOption");for(a=0;c=b[a];++a)d=c.getAttribute("data-option"),Config[d]="checkbox"==c.type?c.checked:c.value;Config.save();SettingsMenu.close();location.href=location.href.replace(/#.+$/,"")},toggle:function(){$.id("settingsMenu")?SettingsMenu.close():SettingsMenu.open()},open:function(){var a,b,c,d,e;Main.firstRun&&Config.save();d=document.createElement("div");d.id="settingsMenu";d.className="UIPanel";c='<div class="extPanel reply"><div class="panelHeader">Settings<span><a target="_blank" href="//www.4chan.org/tools"><img class="pointer" alt="Help" title="Help" src="'+Main.icons.help+'"></a><img alt="Close" title="Close" class="pointer" data-cmd="settings-toggle" src="'+Main.icons.cross+'"></a></span></div><ul>';for(a in SettingsMenu.options)for(b in e=SettingsMenu.options[a],c+='<li class="settings-cat">'+a+"</li>",e)c+="<li><label"+(e[b][1]?' title="'+e[b][1]+'">':">")+'<input type="checkbox" class="menuOption" data-option="'+b+'"'+(Config[b]?' checked="checked">':">")+e[b][0]+"</label></li>";c+='</ul><ul><li><label title="Completely disable the extension (overrides any checked boxes)"><input type="checkbox" class="menuOption" data-option="disableAll"'+(Config.disableAll?' checked="checked">':">")+'Disable the extension</label></li></ul><div class="center"><button data-cmd="settings-export">Export</button><button data-cmd="settings-save">Save</button></div>';d.innerHTML=c;d.addEventListener("click",SettingsMenu.onClick,!1);document.body.appendChild(d)},showExport:function(){var a,b;$.id("exportSettings")||(b=location.href.replace(location.hash,"")+"#cfg="+Config.toURL(),a=document.createElement("div"),a.id="exportSettings",a.className="UIPanel",a.setAttribute("data-cmd","export-close"),a.innerHTML='<div class="extPanel reply"><div class="panelHeader">Export Settings<span><img data-cmd="export-close" class="pointer" alt="Close" title="Close" src="'+Main.icons.cross+'"></span></div><p class="center">Copy and save the URL below, and visit it from another browser or computer to restore your settings.</p><p class="center"><input class="export-field" type="text" readonly="readonly" value="'+b+'"></p><p style="margin-top:15px" class="center">Alternatively, you can drag the link below into your bookmarks bar and click it to restore.</p><p class="center">[<a target="_blank" href="'+b+'">Restore 4chan Settings</a>]</p>',document.body.appendChild(a),a.addEventListener("click",this.onExportClick,!1))},closeExport:function(){var a;if(a=$.id("exportSettings"))a.removeEventListener("click",this.onExportClick,!1),document.body.removeChild(a)},onExportClick:function(a){"exportSettings"==a.target.id&&(a.preventDefault(),a.stopPropagation(),SettingsMenu.closeExport())},onClick:function(a){var b;if("settingsMenu"==a.target.id&&(b=$.id("settingsMenu")))a.preventDefault(),a.stopPropagation(),SettingsMenu.close(b)},close:function(a){if(a=a||$.id("settingsMenu"))a.removeEventListener("click",SettingsMenu.onClick,!1),document.body.removeChild(a)}},Main={init:function(){var a;document.addEventListener("DOMContentLoaded",Main.run,!1);Main.now=Date.now();UA.init();Config.load();Main.firstRun&&Config.loadFromURL()&&(Main.firstRun=!1);Main.firstRun&&/Mobile|Android|Dolfin|Opera Mobi/.test(navigator.userAgent)&&(Config.disableAll=!0);Main.stylesheet=(Main.stylesheet=Main.getCookie(style_group))?Main.stylesheet.toLowerCase().replace(/ /g,"_"):"nws_style"==style_group?"yotsuba_new":"yotsuba_b_new";Main.passEnabled=Main.getCookie("pass_enabled");QR.noCaptcha=QR.noCaptcha||Main.passEnabled;Main.initIcons();Main.addCSS();Main.type=style_group.split("_")[0];a=location.pathname.split(/\//);Main.board=a[1];Main.tid=a[3];Config.IDColor&&IDColor.init();Config.customCSS&&CustomCSS.init();Config.keyBinds&&Keybinds.init();UA.hasCustomEventCtor&&document.dispatchEvent(new CustomEvent("4chanMainInit"))},run:function(){document.removeEventListener("DOMContentLoaded",Main.run,!1);document.addEventListener("click",Main.onclick,!1);$.id("settingsWindowLink").addEventListener("click",SettingsMenu.toggle,!1);$.id("settingsWindowLinkBot").addEventListener("click",SettingsMenu.toggle,!1);$.id("settingsWindowLinkMobile").addEventListener("click",SettingsMenu.toggle,!1);if(!Config.disableAll){if(Config.dropDownNav)$.id("boardNavDesktop").style.display="none",$.id("boardNavDesktopFoot").style.display="none",$.removeClass($.id("boardNavMobile"),"mobile");else if(Main.firstRun)Main.onFirstRun();$.addClass(document.body,Main.stylesheet);$.addClass(document.body,Main.type);Config.compactThreads&&$.addClass(document.body,"compact");if(Config.quotePreview||Config.imageHover||Config.filter)thread=$.id("delform"),thread.addEventListener("mouseover",Main.onThreadMouseOver,!1),thread.addEventListener("mouseout",Main.onThreadMouseOut,!1);Config.hideGlobalMsg&&Main.initGlobalMessage();Config.stickyNav&&Main.setStickyNav();Config.threadExpansion&&ThreadExpansion.init();Config.threadWatcher&&ThreadWatcher.init();Config.filter&&Filter.init();(Config.embedSoundCloud||Config.embedYouTube)&&Media.init();Config.replyHiding&&ReplyHiding.init();Config.threadStats&&Main.tid&&ThreadStats.init();Parser.init();Main.tid?(Main.threadClosed=!document.forms.post,Main.threadSticky=!!$.cls("stickyIcon",$.id("pi"+Main.tid))[0],Config.pageTitle&&Main.setTitle(),Parser.parseThread(Main.tid),Config.threadUpdater&&ThreadUpdater.init()):(Config.topPageNav&&Main.setPageNav(),Config.threadHiding?(ThreadHiding.init(),Parser.parseBoard(),ThreadHiding.purge()):Parser.parseBoard());Config.quickReply&&QR.init();Media.active&&Media.finalize();Config.replyHiding&&ReplyHiding.purge();Config.quotePreview&&QuotePreview.init()}},onFirstRun:function(){var a,b;if(a=$.id("settingsWindowLink"))b=document.createElement("div"),b.id="first-run",b.innerHTML="Click me!",a.parentNode.appendChild(b)},setThreadState:function(a,b){var c,d,e,f;f=a.charAt(0).toUpperCase()+a.slice(1);b?(c=$.cls("postNum",$.id("pi"+Main.tid))[0],d=document.createElement("img"),d.className=a+"Icon retina",d.title=f,d.src=Main.icons2[a],"sticky"==a&&(e=$.cls("closedIcon",c)[0])?(c.insertBefore(d,e),c.insertBefore(document.createTextNode(" "),e)):(c.appendChild(document.createTextNode(" ")),c.appendChild(d))):(d=$.cls(a+"Icon",$.id("pi"+Main.tid))[0],d.parentNode.removeChild(d.previousSibling),d.parentNode.removeChild(d));Main["thread"+f]=b},icons:{up:"arrow_up.png",down:"arrow_down.png",download:"arrow_down2.png",refresh:"refresh.png",cross:"cross.png",gis:"gis.png",iqdb:"iqdb.png",minus:"post_expand_minus.png",plus:"post_expand_plus.png",rotate:"post_expand_rotate.gif",quote:"quote.png",report:"report.png",notwatched:"watch_thread_off.png",watched:"watch_thread_on.png",help:"question.png"},icons2:{closed:"closed.gif",sticky:"sticky.gif",trash:"trash.gif"},initIcons:function(){var a,b;b="//static.4chan.org/image/";if(2<=window.devicePixelRatio){for(a in Main.icons)Main.icons[a]=Main.icons[a].replace(".","@2x.");for(a in Main.icons2)Main.icons2[a]=Main.icons2[a].replace(".","@2x.")}for(a in Main.icons2)Main.icons2[a]=b+Main.icons2[a];b+="buttons/"+{yotsuba_new:"futaba/",futaba_new:"futaba/",yotsuba_b_new:"burichan/",burichan_new:"burichan/",tomorrow:"tomorrow/",photon:"photon/"}[Main.stylesheet];for(a in Main.icons)Main.icons[a]=b+Main.icons[a]},setPageNav:function(){var a,b;b=document.createElement("div");b.setAttribute("data-shiftkey","1");b.setAttribute("data-trackpos","TN-position");b.className="topPageNav";Config["TN-position"]?b.style.cssText=Config["TN-position"]:(b.style.left="10px",b.style.top="50px");a=$.cls("pagelist")[0].cloneNode(!0);b.appendChild(a);Draggable.set(a);document.body.appendChild(b)},initGlobalMessage:function(){var a,b,c;if((a=$.id("globalMessage"))&&a.textContent)a.nextElementSibling.style.clear="both",b=document.createElement("img"),b.id="toggleMsgBtn",b.className="extButton",b.setAttribute("data-cmd","toggleMsg"),b.alt="Toggle",b.title="Toggle announcement",(c=localStorage.getItem("4chan-msg"))&&(Main.msgHash=$.hash(a.textContent))==c?(a.style.display="none",b.style.opacity="0.5",b.src=Main.icons.plus):b.src=Main.icons.minus,a.parentNode.insertBefore(b,a)},toggleGlobalMessage:function(){var a,b;a=$.id("globalMessage");b=$.id("toggleMsgBtn");"none"==a.style.display?(a.style.display="",b.src=Main.icons.minus,b.style.opacity="1",localStorage.removeItem("4chan-msg")):(a.style.display="none",b.src=Main.icons.plus,b.style.opacity="0.5",localStorage.setItem("4chan-msg",Main.msgHash||$.hash(a.textContent)))},setStickyNav:function(){var a,b;a=document.createElement("div");a.id="stickyNav";a.className="extPanel reply";a.setAttribute("data-shiftkey","1");a.setAttribute("data-trackpos","SN-position");Config["SN-position"]?a.style.cssText=Config["SN-position"]:(a.style.right="10px",a.style.top="50px");b=document.createElement("div");b.innerHTML='<img class="pointer" src="'+Main.icons.up+'" data-cmd="totop" alt="\u25b2" title="Top"><img class="pointer" src="'+Main.icons.down+'" data-cmd="tobottom" alt="\u25bc" title="Bottom">';Draggable.set(b);a.appendChild(b);document.body.appendChild(a)},setTitle:function(){var a,b;if(!(a=$.cls("subject",$.id("pi"+Main.tid))[0].textContent))(a=$.id("m"+Main.tid).innerHTML)?(b=document.createElement("span"),b.innerHTML=a.replace(/<br>/g," "),a=b.textContent.slice(0,50)):a="No."+Main.tid;document.title="/"+Main.board+"/ - "+a},getCookie:function(a){var b,c,d;d=a+"=";c=document.cookie.split(";");for(a=0;b=c[a];++a){for(;" "==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(d))return decodeURIComponent(b.substring(d.length,b.length))}return null},onclick:function(a){var b,c;if((b=a.target)!=document)if(c=b.getAttribute("data-cmd"))switch(id=b.getAttribute("data-id"),c){case"update":a.preventDefault();ThreadUpdater.forceUpdate();break;case"auto":ThreadUpdater.toggleAuto();break;case"totop":case"tobottom":a.shiftKey||(location.href="#"+c.slice(2));break;case"hide":ThreadHiding.toggle(id);break;case"watch":ThreadWatcher.toggle(id);break;case"hide-r":ReplyHiding.toggle(id);break;case"expand":ThreadExpansion.toggle(id);break;case"report":Main.reportPost(id);break;case"delete":Main.deletePost(id);break;case"toggleMsg":Main.toggleGlobalMessage();break;case"settings-toggle":SettingsMenu.toggle();break;case"settings-save":SettingsMenu.save();break;case"keybinds-open":Keybinds.open();break;case"filters-open":Filter.open();break;case"css-open":CustomCSS.open();break;case"settings-export":SettingsMenu.showExport();break;case"export-close":SettingsMenu.closeExport()}else Config.disableAll||(QR.enabled&&"Quote this post"==b.title?(a.preventDefault(),c=Main.tid||b.parentNode.parentNode.parentNode.parentNode.parentNode.id.slice(1),QR.show(c),QR.quotePost(!a.ctrlKey&&b.textContent)):Config.imageExpansion&&1==a.which&&b.parentNode&&$.hasClass(b.parentNode,"fileThumb")&&"A"==b.parentNode.nodeName&&!$.hasClass(b.parentNode,"deleted")?(a.preventDefault(),ImageExpansion.toggle(b)):Config.inlineQuotes&&1==a.which&&$.hasClass(b,"quotelink")?a.shiftKey?(a.preventDefault(),location=b.href):Parser.inlineQuote(b,a):Config.threadExpansion&&(b.parentNode&&$.hasClass(b.parentNode,"abbr"))&&(a.preventDefault(),ThreadExpansion.expandComment(b)))},onThreadMouseOver:function(a){var b=a.target;Config.quotePreview&&$.hasClass(b,"quotelink")&&!$.hasClass(b,"deadlink")?QuotePreview.resolve(a.target):Config.imageHover&&b.hasAttribute("data-md5")&&!$.hasClass(b.parentNode,"deleted")?ImageHover.show(b):Config.filter&&b.hasAttribute("data-filtered")&&QuotePreview.show(b,b.href?b.parentNode.parentNode.parentNode:b.parentNode.parentNode)},onThreadMouseOut:function(a){a=a.target;Config.quotePreview&&$.hasClass(a,"quotelink")?QuotePreview.remove(a):Config.imageHover&&a.hasAttribute("data-md5")?ImageHover.hide():Config.filter&&a.hasAttribute("data-filtered")&&QuotePreview.remove(a)},reportPost:function(a){window.open("https://sys.4chan.org/"+Main.board+"/imgboard.php?mode=report&no="+a,Date.now(),"toolbar=0,scrollbars=0,location=0,status=1,menubar=0,resizable=1,width=600,height=170")},linkToThread:function(a,b,c){return"//"+location.host+"/"+(b||Main.board)+"/res/"+a+(0<c?"#p"+c:"")},addCSS:function(){var a;a=document.createElement("style");a.setAttribute("type","text/css");a.textContent='.extButton.threadHideButton {  float: left;  margin-right: 5px;  margin-top: -1px;}.extButton.replyHideButton {  margin-top: 1px;}div.op > span .postHideButtonCollapsed {  margin-right: 1px;}.dropDownNav #boardNavMobile, {  display: block !important;}.extPanel {  border: 1px solid rgba(0, 0, 0, 0.20);}.tomorrow .extPanel {  border: 1px solid #111;}.extButton,img.pointer {  width: 18px;  height: 18px;}.extControls {  display: inline;  margin-left: 5px;}.extButton {  cursor: pointer;  margin-bottom: -4px;}.trashIcon {  width: 16px;  height: 16px;  margin-bottom: -2px;  margin-left: 5px;}.threadUpdateStatus {  margin-left: 0.5ex;}.futaba_new .stub,.burichan_new .stub {  line-height: 1;  padding-bottom: 1px;}.stub .extControls,.stub .wbtn,.stub input {  display: none;}.stub .threadHideButton {  float: none;  margin-right: 2px;}div.post div.postInfo {  width: auto;  display: inline;}.right {  float: right;}.center {  display: block;  margin: auto;}.pointer {  cursor: pointer;}.drag {  cursor: move !important;  user-select: none !important;  -moz-user-select: none !important;  -webkit-user-select: none !important;}#quickReply {  display: block;  position: fixed;  padding: 2px;  font-size: 10pt;}#qrHeader {  text-align: center;  margin-bottom: 1px;  padding: 0;  height: 18px;  line-height: 18px;}#qrClose {  float: right;}#qrForm > div {  clear: both;}#quickReply input[type="text"],#quickReply textarea,#quickReply #recaptcha_response_field {  border: 1px solid #aaa;  font-family: arial,helvetica,sans-serif;  font-size: 10pt;  outline: medium none;  width: 296px;  padding: 2px;  margin: 0 0 1px 0;}#quickReply textarea {  min-width: 296px;  float: left;}#quickReply input:-moz-placeholder,#quickReply textarea:-moz-placeholder {  color: #aaa !important;}#quickReply input[type="submit"] {  width: 83px;  margin: 0;  font-size: 10pt;  float: left;}#quickReply #qrCapField {  display: block;  margin-top: 1px;}#qrCaptcha {  width: 300px;  height: 53px;  cursor: pointer;  border: 1px solid #aaa;  display: block;}#quickReply input.presubmit {  margin-right: 1px;  width: 212px;  float: left;}#qrFile {  width: 215px;  margin-right: 5px;}.yotsuba_new #qrFile {  color:black;}#qrSpoiler {  display: inline;}#qrError {  width: 292px;  display: none;  font-family: monospace;  background-color: #E62020;  font-size: 12px;  color: white;  padding: 3px 5px;  text-shadow: 0 1px rgba(0, 0, 0, 0.20);}#qrError a {  color: white;}#twHeader {  font-weight: bold;  text-align: center;  height: 17px;}.futaba_new #twHeader,.burichan_new #twHeader {  line-height: 1;}#twPrune {  margin-left: 3px;  margin-top: -1px;}#threadWatcher {  max-width: 265px;  display: block;  position: absolute;  padding: 3px;}#watchList {  margin: 0;  padding: 0;  user-select: none;  -moz-user-select: none;  -webkit-user-select: none;}#watchList li:first-child {  margin-top: 3px;  padding-top: 2px;  border-top: 1px solid rgba(0, 0, 0, 0.20);}.photon #watchList li:first-child {  border-top: 1px solid #ccc;}.yotsuba_new #watchList li:first-child {  border-top: 1px solid #d9bfb7;}.yotsuba_b_new #watchList li:first-child {  border-top: 1px solid #b7c5d9;}.tomorrow #watchList li:first-child {  border-top: 1px solid #111;}#watchList a {  text-decoration: none;}#watchList li {  overflow: hidden;  white-space: nowrap;  text-overflow: ellipsis;}.fitToPage {  width: 100%;  max-width: 100%;}div.post div.image-expanded {  display: table;}div.op div.file .image-expanded-anti {  margin-left: -3px;}#quote-preview {  display: block;  position: absolute;  padding: 3px 6px 6px 3px;}#quote-preview .dateTime {  white-space: nowrap;}.yotsuba_new #quote-preview.highlight,.yotsuba_b_new #quote-preview.highlight {  border-width: 1px 2px 2px 1px !important;  border-style: solid !important;}.yotsuba_new #quote-preview.highlight {  border-color: #D99F91 !important;}.yotsuba_b_new #quote-preview.highlight {  border-color: #BA9DBF !important;}.yotsuba_b_new .highlight-anti,.burichan_new .highlight-anti {  border-width: 1px !important;  background-color: #bfa6ba !important;}.yotsuba_new .highlight-anti,.futaba_new .highlight-anti {  background-color: #e8a690 !important;}.tomorrow .highlight-anti {  background-color: #111 !important;  border-color: #111;}.photon .highlight-anti {  background-color: #bbb !important;}#quote-preview .trashIcon,#quote-preview .inlined,#quote-preview .extButton,#quote-preview .extControls {  display: none;}.hasNewReplies {  font-weight: bold;}.deadlink {  text-decoration: line-through !important;}div.backlink {  font-size: 0.8em !important;  display: inline;  padding: 0;  padding-left: 5px;}.backlink span {  padding: 0;}.burichan_new .backlink a,.yotsuba_b_new .backlink a {  color: #34345C !important;}.expbtn {  margin-right: 3px;  margin-left: 2px;}.tCollapsed .rExpanded {  display: none;}#stickyNav {  position: fixed;  font-size: 0;}#stickyNav img {  vertical-align: middle;}.tu-error {  color: red;}.topPageNav {  position: absolute;}.yotsuba_b_new .topPageNav {  border-top: 1px solid rgba(255, 255, 255, 0.25);  border-left: 1px solid rgba(255, 255, 255, 0.25);}.newPostsMarker:not(#quote-preview) {  box-shadow: 0 3px red;}#toggleMsgBtn {  float: left;  margin-bottom: 6px;}.panelHeader {  font-weight: bold;  font-size: 16px;  text-align: center;  margin-bottom: 5px;  margin-top: 5px;  padding-bottom: 5px;  border-bottom: 1px solid rgba(0, 0, 0, 0.20);}.yotsuba_new .panelHeader {  border-bottom: 1px solid #d9bfb7;}.yotsuba_b_new .panelHeader {  border-bottom: 1px solid #b7c5d9;}.tomorrow .panelHeader {  border-bottom: 1px solid #111;}.panelHeader span {  position: absolute;  right: 5px;  top: 5px;}.UIPanel {  position: fixed;  line-height: 14px;  font-size: 14px;  top: 0;  left: 0;  width: 100%;  height: 100%;  background-color: rgba(0, 0, 0, 0.25);  z-index: 9002;}.UIPanel:after {  display: inline-block;  height: 100%;  vertical-align: middle;  content: "";}.UIPanel > div {  -moz-box-sizing: border-box;  box-sizing: border-box;  display: inline-block;  height: auto;  max-height: 100%;  position: relative;  width: 400px;  left: 50%;  margin-left: -200px;  overflow: auto;  box-shadow: 0 0 5px rgba(0, 0, 0, 0.25);  vertical-align: middle;}.UIPanel input[type="text"],.UIPanel textarea {  border: 1px solid #AAA;  outline: none;}.UIPanel .center {  margin-bottom: 5px;}.UIPanel button {  display: inline-block;  margin-right: 5px;}.UIPanel code {  background-color: #eee;  color: #000000;  padding: 1px 4px;  font-size: 12px;}.UIPanel ul {  list-style: none;  padding: 0 0 10px 0;  margin: 0;}.UIPanel .export-field {  width: 385px;}#settingsMenu label input {  margin-right: 5px;}.tomorrow #settingsMenu ul {  border-bottom: 1px solid #282a2e;}.settings-cat {  font-weight: bold;  padding-left: 5px;  margin: 10px 0 5px 0;}#customCSSMenu textarea {  display: block;  max-width: 100%;  min-width: 100%;  -moz-box-sizing: border-box;  box-sizing: border-box;  height: 200px;  margin: 0 0 5px;}#customCSSMenu .right,#settingsMenu .right {  margin-top: 2px;}#settingsMenu label {  display: inline-block;  user-select: none;  -moz-user-select: none;  -webkit-user-select: none;}#filtersHelp > div {  width: 600px;  left: 50%;  margin-left: -300px;}#filtersHelp h4 {  font-size: 15px;  margin: 20px 0 0 10px;}#filtersHelp h4:before {  content: "\u00bb";  margin-right: 3px;}#filtersHelp ul {  padding: 0;  margin: 10px;}#filtersHelp li {  padding: 3px 0;  list-style: none;}#filtersMenu table {  width: 100%;}#filtersMenu th {  font-size: 12px;}#filtersMenu tbody {  text-align: center;}#filtersMenu select,#filtersMenu .fPattern,#filtersMenu .fColor {  padding: 1px;  font-size: 11px;}#filtersMenu select {  width: 85px;}#filtersMenu tfoot td {  padding-top: 10px;}#keybindsHelp li {  padding: 3px 5px;}.fPattern {  width: 150px;}.fColor {  width: 60px;}.fDel {  font-size: 16px;}.filter-preview {  cursor: default;  margin-left: 3px;}#quote-preview iframe,#quote-preview .filter-preview {  display: none;}.post-hidden .extButton,.post-hidden:not(#quote-preview) .postInfo {  opacity: 0.5;}.post-hidden:not(.thread) .postInfo {  padding-left: 5px;}.post-hidden:not(#quote-preview) input,.post-hidden:not(#quote-preview) .replyContainer,.post-hidden:not(#quote-preview) .summary,.post-hidden:not(#quote-preview) .op .file,.post-hidden:not(#quote-preview) .file,.post-hidden .wbtn,.post-hidden .postNum span,.post-hidden:not(#quote-preview) .backlink,div.post-hidden:not(#quote-preview) div.file,div.post-hidden:not(#quote-preview) blockquote.postMessage {  display: none;}#first-run {  border-radius: 5px;  margin-top: 5px;  margin-left: -7px;  padding: 2px 5px;  position: absolute;  font-weight: bold;}.yotsuba_new #first-run,.futaba_new #first-run {  color: #800000;  background-color: #F0E0D6;  border: 2px solid #D9BFB7;}.yotsuba_b_new #first-run,.burichan_new #first-run {  color: #000;  background-color: #D6DAF0;  border: 2px solid #B7C5D9;}.tomorrow #first-run {  color: #C5C8C6;  background-color: #282A2E;  border: 2px solid #111;}.photon #first-run {  color: #333;  background-color: #ddd;  border: 2px solid #ccc;}#first-run:before {  content: "";  border-width: 0 6px 6px;  border-style: solid;  left: 50%;  margin-left: -6px;  position: absolute;  width: 0;  height: 0;  top: -6px;}.yotsuba_new #first-run:before,.futaba_new #first-run:before {  border-color: #D9BFB7 transparent;}.yotsuba_b_new #first-run:before,.burichan_new #first-run:before {  border-color: #B7C5D9 transparent;}.tomorrow #first-run:before {  border-color: #111 transparent;}.photon #first-run:before {  border-color: #ccc transparent;}#first-run:after {  content: "";  border-width: 0 4px 4px;  top: -4px;  display: block;  left: 50%;  margin-left: -4px;  position: absolute;  width: 0;  height: 0;}.yotsuba_new #first-run:after,.futaba_new #first-run:after {  border-color: #F0E0D6 transparent;  border-style: solid;}.yotsuba_b_new #first-run:after,.burichan_new #first-run:after {  border-color: #D6DAF0 transparent;  border-style: solid;}.tomorrow #first-run:after {  border-color: #282A2E transparent;  border-style: solid;}.photon #first-run:after {  border-color: #DDD transparent;  border-style: solid;}.fitToScreen {  position: fixed;  max-width: 100%;  max-height: 100%;  top: 0px;  right: 0px;}.thread-stats {  float: right;}.compact .thread {  max-width: 75%;}.dotted {  text-decoration: none;  border-bottom: 1px dashed;}.inlined .extControls {  display: none;}.linkfade {  opacity: 0.5;}#quote-preview .linkfade {  opacity: 1.0;}kbd {  background-color: #f7f7f7;  color: black;  border: 1px solid #ccc;  border-radius: 3px 3px 3px 3px;  box-shadow: 0 1px 0 #ccc, 0 0 0 2px #fff inset;  font-family: monospace;  font-size: 11px;  line-height: 1.4;  padding: 0 5px;}.deleted:not(#quote-preview) {  opacity: 0.66;}';document.head.appendChild(a)}};Main.init();